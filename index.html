<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>起今知行 | 跨越者</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="爱长腹肌，爱学习的秀秀">
<meta property="og:type" content="website">
<meta property="og:title" content="起今知行 | 跨越者">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="起今知行 | 跨越者">
<meta property="og:description" content="爱长腹肌，爱学习的秀秀">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="起今知行 | 跨越者">
<meta name="twitter:description" content="爱长腹肌，爱学习的秀秀">
  
    <link rel="alternative" href="/atom.xml" title="起今知行 | 跨越者" type="application/atom+xml">
  
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/me.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">yxx</a></h1>
        </hgroup>

        
        <p class="header-subtitle">知我者谓我心忧，不知我者谓我何求</p>
        
        
        <form><input type="text" class="search" placeholder=" Search..."></form>
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="#" title="Email"></a></li>
                            
                                <li id="新浪微博"><a class="新浪微博" target="_blank" href="/weibo" title="新浪微博"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="/GitHub" title="GitHub"></a></li>
                            
                                <li id="微信"><a class="微信" target="_blank" href="/Wechat" title="微信"></a></li>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/personal/" style="font-size: 10px;">personal</a> <a href="/tags/享元模式/" style="font-size: 10px;">享元模式</a> <a href="/tags/代理模式/" style="font-size: 10px;">代理模式</a> <a href="/tags/备忘录模式/" style="font-size: 10px;">备忘录模式</a> <a href="/tags/工厂模式/" style="font-size: 10px;">工厂模式</a> <a href="/tags/抽象工厂模式/" style="font-size: 10px;">抽象工厂模式</a> <a href="/tags/桥接模式/" style="font-size: 10px;">桥接模式</a> <a href="/tags/模板方法模式/" style="font-size: 10px;">模板方法模式</a> <a href="/tags/状态模式/" style="font-size: 10px;">状态模式</a> <a href="/tags/组合模式/" style="font-size: 10px;">组合模式</a> <a href="/tags/装饰模式/" style="font-size: 10px;">装饰模式</a> <a href="/tags/观察者模式/" style="font-size: 10px;">观察者模式</a> <a href="/tags/解释器模式/" style="font-size: 10px;">解释器模式</a> <a href="/tags/设计模式/" style="font-size: 20px;">设计模式</a> <a href="/tags/访问者模式/" style="font-size: 10px;">访问者模式</a> <a href="/tags/责任链模式/" style="font-size: 10px;">责任链模式</a> <a href="/tags/适配器模式/" style="font-size: 10px;">适配器模式</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://androidwolf.github.io/">Me</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/androidwolf">GitHub</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/bug_moving">CSND</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">爱谈天跨地的秀秀</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">yxx</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img lazy-src="/img/me.jpg" class="js-avatar">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">yxx</a></h1>
            </hgroup>
            
            <p class="header-subtitle">知我者谓我心忧，不知我者谓我何求</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="#" title="Email"></a></li>
                            
                                <li id="新浪微博"><a class="新浪微博" target="_blank" href="/weibo" title="新浪微博"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="/GitHub" title="GitHub"></a></li>
                            
                                <li id="微信"><a class="微信" target="_blank" href="/Wechat" title="微信"></a></li>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-Java设计模式--组合模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/17/Java设计模式--组合模式/" class="article-date">
      <time datetime="2016-09-17T09:33:06.000Z" itemprop="datePublished">2016-09-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/17/Java设计模式--组合模式/">Java设计模式--组合模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="组合模式"><a href="#组合模式" class="headerlink" title="组合模式"></a>组合模式</h1><p>将对象组合成树形结构以表示“部分-整体”的层次结构。Composite使用户对单个对象和组合对象的使用具有一致性。</p>
<h1 id="Composite-Pattern"><a href="#Composite-Pattern" class="headerlink" title="Composite Pattern"></a>Composite Pattern</h1><p>Compose objects into tree structures to represent part-whole hierarchies. Composite lets clients treat individual objects and compositions of objects uniformly.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://ww4.sinaimg.cn/large/0060lm7Tgw1f7y30gvbtxj30hy0crdha.jpg" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>组合方法模式的结构中包括三种角色。</p>
<ul>
<li>抽象组件（Abstract Component）：是一个接口（抽象类），该接口（抽象类）定义了个体对象和组合对象需要实现的关于操作其子节点的方法，比如add()、remove()以及getChild()等方法。抽象组件也可以定义个体对象和组合对象用于操作其自身的方法，比如isLeaf()方法等。</li>
<li>Composite（Composite Node）：实现Component接口类的实例，Composite节点不仅实现Component接口，而且可以含有其他Composite节点或Leaf节点的引用。</li>
<li>Leaf节点（Leaf Node）：实现Component接口类的实例，Leaf节点实现Composite接口，不可以含有其他Composite节点或Leaf节点的引用，因此，叶节点在实现Component接口有关操作子节点的方法时，比如add()、remove()和getChild()方法，可让方法抛出一个异常，也可以实现为空操作。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Component的接口类MilitaryPerson-java"><a href="#Component的接口类MilitaryPerson-java" class="headerlink" title="Component的接口类MilitaryPerson.java"></a>Component的接口类MilitaryPerson.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Component;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MilitaryPerson</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(MilitaryPerson person)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(MilitaryPerson person)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> MilitaryPerson <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> index)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> Iterator&lt;MilitaryPerson&gt; <span class="title">getAllChildren</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLeaf</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getSalary</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalary</span><span class="params">(<span class="keyword">double</span> salary)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Composite的实现类MilitaryOfficer-java"><a href="#Composite的实现类MilitaryOfficer-java" class="headerlink" title="Composite的实现类MilitaryOfficer.java"></a>Composite的实现类MilitaryOfficer.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Component;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"><span class="keyword">import</span> java.util.LinkedList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MilitaryOfficer</span> <span class="keyword">implements</span> <span class="title">MilitaryPerson</span> </span>&#123;</div><div class="line"></div><div class="line">	LinkedList&lt;MilitaryPerson&gt; list;</div><div class="line">	String name;</div><div class="line">	<span class="keyword">double</span> salary;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MilitaryOfficer</span><span class="params">(String name, <span class="keyword">double</span> salary)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">		<span class="keyword">this</span>.salary = salary;</div><div class="line">		list = <span class="keyword">new</span> LinkedList&lt;MilitaryPerson&gt;();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(MilitaryPerson person)</span> </span>&#123;</div><div class="line">		list.add(person);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(MilitaryPerson person)</span> </span>&#123;</div><div class="line">		list.remove(person);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> MilitaryPerson <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> list.get(index);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Iterator&lt;MilitaryPerson&gt; <span class="title">getAllChildren</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> list.iterator();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLeaf</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getSalary</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> salary;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalary</span><span class="params">(<span class="keyword">double</span> salary)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.salary = salary;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Leaf的实现类MilitarySoldier-java"><a href="#Leaf的实现类MilitarySoldier-java" class="headerlink" title="Leaf的实现类MilitarySoldier.java"></a>Leaf的实现类MilitarySoldier.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Component;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MilitarySoldier</span> <span class="keyword">implements</span> <span class="title">MilitaryPerson</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">double</span> salary;</div><div class="line">	String name;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MilitarySoldier</span><span class="params">(<span class="keyword">double</span> salary, String name)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.salary = salary;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(MilitaryPerson person)</span> </span>&#123;&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(MilitaryPerson person)</span> </span>&#123;&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> MilitaryPerson <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Iterator&lt;MilitaryPerson&gt; <span class="title">getAllChildren</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLeaf</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getSalary</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> salary;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalary</span><span class="params">(<span class="keyword">double</span> salary)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.salary = salary;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="计算工资的工具类ComputerSalary-java"><a href="#计算工资的工具类ComputerSalary-java" class="headerlink" title="计算工资的工具类ComputerSalary.java"></a>计算工资的工具类ComputerSalary.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Component;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ComputerSalary</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">computerSalary</span><span class="params">(MilitaryPerson person)</span> </span>&#123;</div><div class="line">		<span class="keyword">double</span> sum = <span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span> (person.isLeaf() == <span class="keyword">true</span>) &#123;</div><div class="line">			sum = sum + person.getSalary();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (person.isLeaf() == <span class="keyword">false</span>) &#123;</div><div class="line">			sum = sum + person.getSalary();</div><div class="line">			Iterator&lt;MilitaryPerson&gt; iterator = person.getAllChildren();</div><div class="line">			<span class="keyword">while</span> (iterator.hasNext()) &#123;</div><div class="line">				MilitaryPerson p = iterator.next();</div><div class="line">				sum = sum + computerSalary(p);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> sum;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Component;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		MilitaryPerson 连长 = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"连长"</span>, <span class="number">5000</span>);</div><div class="line">		MilitaryPerson 排长<span class="number">1</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"一排长"</span>, <span class="number">4000</span>);</div><div class="line">		MilitaryPerson 排长<span class="number">2</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"二排长"</span>, <span class="number">4000</span>);</div><div class="line">		MilitaryPerson 排长<span class="number">3</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"三排长"</span>, <span class="number">4000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">11</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"一排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">12</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"二排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">13</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"三排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">21</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"一排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">22</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"二排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">23</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"三排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">31</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"一排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">32</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"二排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">33</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"三排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson[] 士兵 = <span class="keyword">new</span> MilitarySoldier[<span class="number">90</span>];</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; 士兵.length; i++) &#123;</div><div class="line">			士兵[i] = <span class="keyword">new</span> MilitarySoldier(<span class="number">1000</span>, <span class="string">"小兵"</span>);</div><div class="line">		&#125;</div><div class="line">		连长.add(排长<span class="number">1</span>);</div><div class="line">		连长.add(排长<span class="number">2</span>);</div><div class="line">		排长<span class="number">1</span>.add(班长<span class="number">11</span>);</div><div class="line">		排长<span class="number">1</span>.add(班长<span class="number">12</span>);</div><div class="line">		排长<span class="number">1</span>.add(班长<span class="number">13</span>);</div><div class="line">		排长<span class="number">2</span>.add(班长<span class="number">21</span>);</div><div class="line">		排长<span class="number">2</span>.add(班长<span class="number">22</span>);</div><div class="line">		排长<span class="number">2</span>.add(班长<span class="number">23</span>);</div><div class="line">		排长<span class="number">3</span>.add(班长<span class="number">31</span>);</div><div class="line">		排长<span class="number">3</span>.add(班长<span class="number">32</span>);</div><div class="line">		排长<span class="number">3</span>.add(班长<span class="number">33</span>);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; i++) &#123;</div><div class="line">			班长<span class="number">11</span>.add(士兵[i]);</div><div class="line">			班长<span class="number">12</span>.add(士兵[i + <span class="number">10</span>]);</div><div class="line">			班长<span class="number">13</span>.add(士兵[i + <span class="number">20</span>]);</div><div class="line">			班长<span class="number">21</span>.add(士兵[i + <span class="number">30</span>]);</div><div class="line">			班长<span class="number">22</span>.add(士兵[i + <span class="number">40</span>]);</div><div class="line">			班长<span class="number">23</span>.add(士兵[i + <span class="number">50</span>]);</div><div class="line">			班长<span class="number">31</span>.add(士兵[i + <span class="number">60</span>]);</div><div class="line">			班长<span class="number">32</span>.add(士兵[i + <span class="number">70</span>]);</div><div class="line">			班长<span class="number">33</span>.add(士兵[i + <span class="number">80</span>]);</div><div class="line">		&#125;</div><div class="line">		System.out.println(<span class="string">"一排的军饷:"</span> + ComputerSalary.computerSalary(排长<span class="number">1</span>));</div><div class="line">		System.out.println(<span class="string">"一班的军饷:"</span> + ComputerSalary.computerSalary(班长<span class="number">11</span>));</div><div class="line">		System.out.println(<span class="string">"全连的军饷:"</span> + ComputerSalary.computerSalary(连长));</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="执行效果图"><a href="#执行效果图" class="headerlink" title="执行效果图"></a>执行效果图</h1><p><img src="http://ww1.sinaimg.cn/large/0060lm7Tgw1f7y3oc3j9lj30d604tjsc.jpg" alt=""></p>
<h1 id="组合模式的优点"><a href="#组合模式的优点" class="headerlink" title="组合模式的优点"></a>组合模式的优点</h1><ul>
<li>组合模式中包含个体对象和组合对象，并形成树形结构，使用户可以方便地处理个体对象和组合对象。</li>
<li>组合对象和个体对象实现了相同的接口，用户一般无须区分个体对象和组合对象。</li>
<li>当增加新的Composite节点和Leaf节点时，用户的重要代码不需要作出修改，例如，如果增加一个创建企业领导和一般职员的Composite节点和Leaf节点，那么ComputerSalary并不需要修改，就可以计算一个部门的薪水总和。</li>
</ul>
<h1 id="适用组合模式的情景"><a href="#适用组合模式的情景" class="headerlink" title="适用组合模式的情景"></a>适用组合模式的情景</h1><ul>
<li>当想表示对象的部分-整体层次结构。</li>
<li>希望用户用一致的方式处理个体对象和组合对象。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/组合模式/">组合模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--桥接模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/17/Java设计模式--桥接模式/" class="article-date">
      <time datetime="2016-09-17T07:15:06.000Z" itemprop="datePublished">2016-09-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/17/Java设计模式--桥接模式/">Java设计模式--桥接模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="桥接模式（别名：柄体模式）"><a href="#桥接模式（别名：柄体模式）" class="headerlink" title="桥接模式（别名：柄体模式）"></a>桥接模式（别名：柄体模式）</h1><p>将抽象部分于它的实现部分分离，使它们都可以独立地变化。</p>
<h1 id="Bridge-Pattern（Another-Name：Handle-Body）"><a href="#Bridge-Pattern（Another-Name：Handle-Body）" class="headerlink" title="Bridge Pattern（Another Name：Handle-Body）"></a>Bridge Pattern（Another Name：Handle-Body）</h1><p>Decouple an abstraction from its implementation so that the two can vary independently.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://i1.piimg.com/4851/c1df39cd4c5e374b.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>桥接模式的结构中包括四种角色。</p>
<ul>
<li>抽象（Abstraction）：是一个抽象类，该抽象类含有Implementor声明的变量，即维护一个Implementor类型对象。</li>
<li>实现者（Implementor）：实现者角色是一个接口（抽象类），该接口（抽象类）中的方法不一定与Abstraction类中的方法一致。Implementor接口（抽象类）负责定义基本操作，而Abstraction类负责定义基于这些基本操作的较高层次的操作。</li>
<li>细化抽象（Refined Abstration）：细化抽象是抽象角色的一个子类，该子类在重写（覆盖）抽象角色中的抽象方法时，在给出一些必要的操作后，将委托所维护Implementor类型对象调用相应的方法。</li>
<li>具体实现者（Concrete Implementor）：具体实现者是实现（扩展）Implementor接口（抽象类）的类。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Abstract-Template的抽象类CCTV-java"><a href="#Abstract-Template的抽象类CCTV-java" class="headerlink" title="Abstract Template的抽象类CCTV.java"></a>Abstract Template的抽象类CCTV.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JPanel;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CCTV</span> <span class="keyword">extends</span> <span class="title">JPanel</span> </span>&#123;</div><div class="line">	Program programMaker;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">makeProgram</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Abstract-Template的实现类CCTV5-java"><a href="#Abstract-Template的实现类CCTV5-java" class="headerlink" title="Abstract Template的实现类CCTV5.java"></a>Abstract Template的实现类CCTV5.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.awt.BorderLayout;</div><div class="line"><span class="keyword">import</span> java.awt.Font;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JLabel;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CCTV5</span> <span class="keyword">extends</span> <span class="title">CCTV</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</div><div class="line"></div><div class="line">	JLabel showFilm;</div><div class="line">	Thread thread;</div><div class="line">	ArrayList&lt;String&gt; content;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CCTV5</span><span class="params">(Program program)</span> </span>&#123;</div><div class="line">		programMaker = program;</div><div class="line">		setLayout(<span class="keyword">new</span> BorderLayout());</div><div class="line">		showFilm = <span class="keyword">new</span> JLabel(<span class="string">"CCTV5频道"</span>);</div><div class="line">		showFilm.setFont(<span class="keyword">new</span> Font(<span class="string">""</span>, Font.BOLD, <span class="number">39</span>));</div><div class="line">		add(showFilm, BorderLayout.CENTER);</div><div class="line">		thread = <span class="keyword">new</span> Thread(<span class="keyword">this</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content = programMaker.makeTVProgram();</div><div class="line">		<span class="keyword">if</span> (!thread.isAlive()) &#123;</div><div class="line">			thread = <span class="keyword">new</span> Thread(<span class="keyword">this</span>);</div><div class="line">			thread.start();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; content.size(); i++) &#123;</div><div class="line">			showFilm.setText(content.get(i));</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				Thread.sleep(<span class="number">500</span>);</div><div class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Abstract-Template的实现类CCTV6-java"><a href="#Abstract-Template的实现类CCTV6-java" class="headerlink" title="Abstract Template的实现类CCTV6.java"></a>Abstract Template的实现类CCTV6.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.awt.BorderLayout;</div><div class="line"><span class="keyword">import</span> java.awt.Font;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JLabel;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CCTV6</span> <span class="keyword">extends</span> <span class="title">CCTV</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</div><div class="line"></div><div class="line">	JLabel showFilm;</div><div class="line">	Thread thread;</div><div class="line">	ArrayList&lt;String&gt; content;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CCTV6</span><span class="params">(Program program)</span> </span>&#123;</div><div class="line">		programMaker = program;</div><div class="line">		setLayout(<span class="keyword">new</span> BorderLayout());</div><div class="line">		showFilm = <span class="keyword">new</span> JLabel(<span class="string">"CCTV6频道"</span>);</div><div class="line">		showFilm.setFont(<span class="keyword">new</span> Font(<span class="string">""</span>, Font.BOLD, <span class="number">39</span>));</div><div class="line">		add(showFilm, BorderLayout.CENTER);</div><div class="line">		thread = <span class="keyword">new</span> Thread(<span class="keyword">this</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content = programMaker.makeTVProgram();</div><div class="line">		<span class="keyword">if</span> (!thread.isAlive()) &#123;</div><div class="line">			thread = <span class="keyword">new</span> Thread(<span class="keyword">this</span>);</div><div class="line">			thread.start();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; content.size(); i++) &#123;</div><div class="line">			showFilm.setText(content.get(i));</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				Thread.sleep(<span class="number">500</span>);</div><div class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Implementor的接口类Program-java"><a href="#Implementor的接口类Program-java" class="headerlink" title="Implementor的接口类Program.java"></a>Implementor的接口类Program.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Program</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> ArrayList&lt;String&gt; <span class="title">makeTVProgram</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Implementor的实现类AthleticProgram-java"><a href="#Implementor的实现类AthleticProgram-java" class="headerlink" title="Implementor的实现类AthleticProgram.java"></a>Implementor的实现类AthleticProgram.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AthleticProgram</span> <span class="keyword">implements</span> <span class="title">Program</span> </span>&#123;</div><div class="line"></div><div class="line">	ArrayList&lt;String&gt; content;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">AthleticProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> ArrayList&lt;String&gt; <span class="title">makeTVProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content.clear();</div><div class="line">		content.add(<span class="string">"足球直播"</span>);</div><div class="line">		content.add(<span class="string">"篮球直播"</span>);</div><div class="line">		content.add(<span class="string">"羽毛球直播"</span>);</div><div class="line">		content.add(<span class="string">"兵乓球直播"</span>);</div><div class="line">		content.add(<span class="string">"直播结束"</span>);</div><div class="line">		<span class="keyword">return</span> content;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Implementor的实现类FilmProgram-java"><a href="#Implementor的实现类FilmProgram-java" class="headerlink" title="Implementor的实现类FilmProgram.java"></a>Implementor的实现类FilmProgram.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilmProgram</span> <span class="keyword">implements</span> <span class="title">Program</span> </span>&#123;</div><div class="line"></div><div class="line">	ArrayList&lt;String&gt; content;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">FilmProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> ArrayList&lt;String&gt; <span class="title">makeTVProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content.clear();</div><div class="line">		content.add(<span class="string">"惊天魔盗团"</span>);</div><div class="line">		content.add(<span class="string">"兵临城下"</span>);</div><div class="line">		content.add(<span class="string">"海芋恋"</span>);</div><div class="line">		content.add(<span class="string">"寒战"</span>);</div><div class="line">		content.add(<span class="string">"电影结束"</span>);</div><div class="line">		<span class="keyword">return</span> content;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.awt.BorderLayout;</div><div class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</div><div class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JButton;</div><div class="line"><span class="keyword">import</span> javax.swing.JFrame;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> <span class="keyword">extends</span> <span class="title">JFrame</span> </span>&#123;</div><div class="line"></div><div class="line">	JButton seeProgram;</div><div class="line">	CCTV cctv;</div><div class="line">	Program program;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Application</span><span class="params">(CCTV tv, Program program)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.cctv = tv;</div><div class="line">		<span class="keyword">this</span>.program = program;</div><div class="line">		add(cctv, BorderLayout.CENTER);</div><div class="line">		seeProgram = <span class="keyword">new</span> JButton(<span class="string">"看节目"</span>);</div><div class="line">		add(seeProgram, BorderLayout.SOUTH);</div><div class="line">		seeProgram.addActionListener(<span class="keyword">new</span> ActionListener() &#123;</div><div class="line">			</div><div class="line">			<span class="meta">@Override</span></div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</div><div class="line">				cctv.makeProgram();</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		setVisible(<span class="keyword">true</span>);</div><div class="line">		setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Program program = <span class="keyword">new</span> AthleticProgram();</div><div class="line">		CCTV cctv = <span class="keyword">new</span> CCTV5(program);</div><div class="line">		Application application1 = <span class="keyword">new</span> Application(cctv, program);</div><div class="line">		application1.setBounds(<span class="number">10</span>, <span class="number">10</span>, <span class="number">200</span>, <span class="number">300</span>);</div><div class="line">		program = <span class="keyword">new</span> FilmProgram();</div><div class="line">		cctv = <span class="keyword">new</span> CCTV6(program);</div><div class="line">		Application application2 = <span class="keyword">new</span> Application(cctv, program);</div><div class="line">		application2.setBounds(<span class="number">220</span>, <span class="number">10</span>, <span class="number">200</span>, <span class="number">300</span>);	</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="运行截图"><a href="#运行截图" class="headerlink" title="运行截图"></a>运行截图</h1><p><img src="http://i2.buimg.com/4851/c22c3dbeac863c85.png" alt=""></p>
<h1 id="桥接模式的优点"><a href="#桥接模式的优点" class="headerlink" title="桥接模式的优点"></a>桥接模式的优点</h1><ul>
<li>桥接模式分离实现与抽象，使抽象和实现可以独立的扩展。当修改实现的代码时，不影响抽象的代码，反之也一样。</li>
<li>满足开闭-原则。抽象和实现者处于同层次，使系统可独立地扩展这两个层次。增加新的具体实现者，不需要修改细化抽象，反之增加新的细化抽象也不需要修改具体实现。</li>
</ul>
<h1 id="适用桥接模式的情景"><a href="#适用桥接模式的情景" class="headerlink" title="适用桥接模式的情景"></a>适用桥接模式的情景</h1><ul>
<li>不想让抽象和某些重要的实现代码是固定的绑定关系，这部分实现可运行时动态决定。</li>
<li>抽象和实现者都可以继承的方式独立地扩充而互不影响，程序在运行期间可能需要动态的将一个抽象的子类的实例与一个实现者的子类的实例进行结合。</li>
<li>希望对实现者层次代码的修改对抽象层不产生影响，即抽象层的代码不必重新编译，反之亦然。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/桥接模式/">桥接模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--模板方法模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/17/Java设计模式--模板方法模式/" class="article-date">
      <time datetime="2016-09-17T06:34:06.000Z" itemprop="datePublished">2016-09-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/17/Java设计模式--模板方法模式/">Java设计模式--模板方法模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="模板方法模式"><a href="#模板方法模式" class="headerlink" title="模板方法模式"></a>模板方法模式</h1><p>定义一个操作中算法的骨架，而将一些步骤延迟到子类中。模板方法使子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。</p>
<h1 id="Template-Method-Pattern"><a href="#Template-Method-Pattern" class="headerlink" title="Template Method Pattern"></a>Template Method Pattern</h1><p>Define the skeleton of an algorithm in an operation, deferring some steps to subclasses. Template Method lets subclasses redefine certain steps of an algorithm without changing the algorithm’s structure.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://i4.piimg.com/4851/0bf522202e7a3596.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>模板方法方法模式的结构中包括两种角色。</p>
<ul>
<li>抽象模板（Abstract Template）：抽象模板是一个抽象类。抽象模板定义了若干个方法以表示一个算法的各个步骤，这些方法中有抽象方法也有非抽象方法，其中的抽象方法称作原语操作(Primitive Operation)。重要的一点是，抽象模板中还定义了一个称作模板方法的方法，该方法不仅包含有抽象模板中表示算法步骤的方法调用，而且也可以包含有定义在抽象模板中的其他对象的方法调用，即模板方法定义了算法的骨架。</li>
<li>具体模板（Concrete Template）：具体模板是抽象模板的子类，实现抽象模板中的原语操作。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Abstract-Template的抽象类AbstractTemplate-java"><a href="#Abstract-Template的抽象类AbstractTemplate-java" class="headerlink" title="Abstract Template的抽象类AbstractTemplate.java"></a>Abstract Template的抽象类AbstractTemplate.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> TemplateMethod;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractTemplate</span> </span>&#123;</div><div class="line">	File[] allFiles;</div><div class="line">	File dir;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">AbstractTemplate</span><span class="params">(File dir)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.dir = dir;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">showFileName</span><span class="params">()</span> </span>&#123;</div><div class="line">		allFiles = dir.listFiles();</div><div class="line">		sort();</div><div class="line">		printFiles();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">printFiles</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Abstract-Template的实现类ConcreteTemplate1-java"><a href="#Abstract-Template的实现类ConcreteTemplate1-java" class="headerlink" title="Abstract Template的实现类ConcreteTemplate1.java"></a>Abstract Template的实现类ConcreteTemplate1.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> TemplateMethod;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.sql.Date;</div><div class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteTemplate1</span> <span class="keyword">extends</span> <span class="title">AbstractTemplate</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ConcreteTemplate1</span><span class="params">(File dir)</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>(dir);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; allFiles.length; i++) &#123;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; allFiles.length; j++) &#123;</div><div class="line">				<span class="keyword">if</span> (allFiles[j].lastModified() &lt; allFiles[i].lastModified()) &#123;</div><div class="line">					File file = allFiles[j];</div><div class="line">					allFiles[j] = allFiles[i];</div><div class="line">					allFiles[i] = file;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printFiles</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; allFiles.length; i++) &#123;</div><div class="line">			<span class="keyword">long</span> time = allFiles[i].lastModified();</div><div class="line">			Date date = <span class="keyword">new</span> Date(time);</div><div class="line">			SimpleDateFormat matter = <span class="keyword">new</span> SimpleDateFormat(</div><div class="line">					<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</div><div class="line">			String str = matter.format(date);</div><div class="line">			String name = allFiles[i].getName();</div><div class="line">			<span class="keyword">int</span> k = i + <span class="number">1</span>;</div><div class="line">			System.out.println(k + <span class="string">" "</span> + name + <span class="string">"("</span> + str + <span class="string">")"</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Abstract-Template的实现类ConcreteTemplate2-java"><a href="#Abstract-Template的实现类ConcreteTemplate2-java" class="headerlink" title="Abstract Template的实现类ConcreteTemplate2.java"></a>Abstract Template的实现类ConcreteTemplate2.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> TemplateMethod;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteTemplate2</span> <span class="keyword">extends</span> <span class="title">AbstractTemplate</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ConcreteTemplate2</span><span class="params">(File dir)</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>(dir);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; allFiles.length; i++) &#123;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; allFiles.length; j++) &#123;</div><div class="line">				<span class="keyword">if</span> (allFiles[j].lastModified() &lt; allFiles[i].lastModified()) &#123;</div><div class="line">					File file = allFiles[j];</div><div class="line">					allFiles[j] = allFiles[i];</div><div class="line">					allFiles[i] = file;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printFiles</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; allFiles.length; i++) &#123;</div><div class="line">			<span class="keyword">long</span> fileSize = allFiles[i].length();</div><div class="line">			String name = allFiles[i].getName();</div><div class="line">			<span class="keyword">int</span> k = i + <span class="number">1</span>;</div><div class="line">			System.out.println(k + <span class="string">" "</span> + name + <span class="string">"("</span> + fileSize + <span class="string">"字节)"</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> TemplateMethod;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		File dir = <span class="keyword">new</span> File(<span class="string">"d:/java/masm5"</span>);</div><div class="line">		AbstractTemplate template = <span class="keyword">new</span> ConcreteTemplate1(dir);</div><div class="line">		System.out.println(dir.getPath() + <span class="string">"目录下的文件:"</span>);</div><div class="line">		template.showFileName();</div><div class="line">		template = <span class="keyword">new</span> ConcreteTemplate2(dir);</div><div class="line">		System.out.println(dir.getPath() + <span class="string">"目录下的文件:"</span>);</div><div class="line">		template.showFileName();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="执行效果图"><a href="#执行效果图" class="headerlink" title="执行效果图"></a>执行效果图</h1><p><img src="http://i4.piimg.com/4851/fb765e7e5ec307ee.png" alt=""></p>
<h1 id="电脑目录下文件截图"><a href="#电脑目录下文件截图" class="headerlink" title="电脑目录下文件截图"></a>电脑目录下文件截图</h1><p><img src="http://i4.piimg.com/4851/fa566b5bace8fae9.png" alt=""></p>
<h1 id="钩子方法"><a href="#钩子方法" class="headerlink" title="钩子方法"></a>钩子方法</h1><p>有时间一定补，不过下面优点介绍了一点钩子的好处</p>
<h1 id="模板方法模式的优点"><a href="#模板方法模式的优点" class="headerlink" title="模板方法模式的优点"></a>模板方法模式的优点</h1><ul>
<li>可以通过在抽象模板定义模板方法给出成熟的算法步骤，同时又不限制步骤的细节，具体模板实现算法细节不会改变整个算法的骨架。</li>
<li>在抽象模板模式中，可以通过钩子方法对某些步骤进行挂钩，具体模板通过钩子可以选择算法骨架中的某些步骤。</li>
</ul>
<h1 id="适用模板方法模式的情景"><a href="#适用模板方法模式的情景" class="headerlink" title="适用模板方法模式的情景"></a>适用模板方法模式的情景</h1><ul>
<li>设计者需要给出一个算法的固定步骤，并将某些步骤的具体实现留给子类来实现。</li>
<li>需要对代码进行重构，将各个子类公共行为提取出来集中到一个共同的父类中以避免代码重复。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/模板方法模式/">模板方法模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--代理模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/17/Java设计模式--代理模式/" class="article-date">
      <time datetime="2016-09-17T01:53:06.000Z" itemprop="datePublished">2016-09-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/17/Java设计模式--代理模式/">Java设计模式--代理模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h1><p>为其他对象提供一种代理以控制对这个对象的访问。</p>
<h1 id="Proxy-Pattern"><a href="#Proxy-Pattern" class="headerlink" title="Proxy Pattern"></a>Proxy Pattern</h1><p>Provide a surrogate or placeholder for another object to control access to it.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://i2.buimg.com/4851/c272a00cd9ca21fb.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>代理方法模式的结构中包括三种角色。</p>
<ul>
<li>抽象主题（Subject）：抽象主题是一个接口，该接口是对象和它的代理所共用的接口，即是RealSubject角色和Proxy角色实例所实现的接口。</li>
<li>实际主题（RealSubject）：实际主题是实现抽象主题接口的类。实际主题的实例是代理角色(Proxy)实例所要代理的对象。</li>
<li>代理（Proxy）：代理是实现抽象主题接口的类(代理和实际主题实现了相同的接口)。代理含有主题接口声明的变量，该变量用来存放RealSubject角色的实例引用，这样一来，代理的实例就可以控制对它所包含的RealSubject角色的实例访问，即可以控制对它所代理对象的访问。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Subject的接口类Geometry-java"><a href="#Subject的接口类Geometry-java" class="headerlink" title="Subject的接口类Geometry.java"></a>Subject的接口类Geometry.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Proxy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Geometry</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getArea</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="RealSubject的实现类Triangle-java"><a href="#RealSubject的实现类Triangle-java" class="headerlink" title="RealSubject的实现类Triangle.java"></a>RealSubject的实现类Triangle.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Proxy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Triangle</span> <span class="keyword">implements</span> <span class="title">Geometry</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">double</span> sideA, sideB, sideC, area;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Triangle</span><span class="params">(<span class="keyword">double</span> sideA, <span class="keyword">double</span> sideB, <span class="keyword">double</span> sideC)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.sideA = sideA;</div><div class="line">		<span class="keyword">this</span>.sideB = sideB;</div><div class="line">		<span class="keyword">this</span>.sideC = sideC;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getArea</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">double</span> p = (sideA + sideB + sideC) / <span class="number">2.0</span>;</div><div class="line">		area = Math.sqrt(p * (p - sideA) * (p - sideB) * (p - sideC));</div><div class="line">		<span class="keyword">return</span> area;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Proxy的实现类TriangleProxy-java"><a href="#Proxy的实现类TriangleProxy-java" class="headerlink" title="Proxy的实现类TriangleProxy.java"></a>Proxy的实现类TriangleProxy.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Proxy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TriangleProxy</span> <span class="keyword">implements</span> <span class="title">Geometry</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">double</span> sideA, sideB, sideC;</div><div class="line">	Triangle triangle;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setABC</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> c)</span> </span>&#123;</div><div class="line">		sideA = a;</div><div class="line">		sideB = b;</div><div class="line">		sideC = c;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getArea</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (sideA + sideB &gt; sideC &amp;&amp; sideA + sideC &gt; sideB</div><div class="line">				&amp;&amp; sideB + sideC &gt; sideA) &#123;</div><div class="line">			triangle = <span class="keyword">new</span> Triangle(sideA, sideB, sideC);</div><div class="line">			<span class="keyword">double</span> area = triangle.getArea();</div><div class="line">			<span class="keyword">return</span> area;</div><div class="line">		&#125; <span class="keyword">else</span></div><div class="line">			<span class="keyword">return</span> -<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Proxy;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Scanner reader = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">		System.out.println(<span class="string">"请输入三个数"</span>);</div><div class="line">		<span class="keyword">double</span> a,b,c;</div><div class="line">		a = reader.nextDouble();</div><div class="line">		b = reader.nextDouble();</div><div class="line">		c = reader.nextDouble();</div><div class="line">		TriangleProxy tp = <span class="keyword">new</span> TriangleProxy();</div><div class="line">		tp.setABC(a, b, c);</div><div class="line">		System.out.println(<span class="string">"面积是:"</span> + tp.getArea());</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="执行效果图"><a href="#执行效果图" class="headerlink" title="执行效果图"></a>执行效果图</h1><p><img src="http://i2.buimg.com/4851/21f377b981f39c9d.png" alt=""></p>
<h1 id="远程代理"><a href="#远程代理" class="headerlink" title="远程代理"></a>远程代理</h1><p>先空着，有时间补</p>
<h1 id="代理模式的优点"><a href="#代理模式的优点" class="headerlink" title="代理模式的优点"></a>代理模式的优点</h1><ul>
<li>使用代理模式可以让用户的代码和某个特定类的子类的代码解耦。</li>
<li>代理方法的使用用户不必知道它所使用的对象是怎么被创建的，只需要知道该对象有哪些方法即可。</li>
</ul>
<h1 id="适用代理模式的情景"><a href="#适用代理模式的情景" class="headerlink" title="适用代理模式的情景"></a>适用代理模式的情景</h1><ul>
<li>用户需要一个类的子类的实例，但不希望与该类的子类形成耦合。</li>
<li>用户需要一个类的子类的实例，但用户不知道该类有哪些子类可用。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/代理模式/">代理模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--访问者模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/16/Java设计模式--访问者模式/" class="article-date">
      <time datetime="2016-09-16T02:52:06.000Z" itemprop="datePublished">2016-09-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/16/Java设计模式--访问者模式/">Java设计模式--访问者模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="访问者模式-别名：虚拟构造"><a href="#访问者模式-别名：虚拟构造" class="headerlink" title="访问者模式(别名：虚拟构造)"></a>访问者模式(别名：虚拟构造)</h1><p>表示一个作用于某对象结构中的各个元素的操作。它可以在不改变各个元素的类的前提下定义作用于这些元素的新操作。</p>
<h1 id="Visitor-Pattern"><a href="#Visitor-Pattern" class="headerlink" title="Visitor Pattern"></a>Visitor Pattern</h1><p>Represent an operation to be preformed on the elements of an object structure. Visitor lets you define a new operation without changing the classes of the elements on which it operator.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://i2.buimg.com/4851/7c53b257d8960953.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>访问者模式的结构中包括五种角色。</p>
<ul>
<li>抽象元素（Element）：一个抽象类，该类定义了接口访问者的accept操作。</li>
<li>具体元素（Concrete Element）：Element的子类。</li>
<li>对象结构（Object Structure）：一个集合，用于存放Element对象，提供遍历它自己的方法。</li>
<li>抽象访问者（Visitor）：一个接口，该接口定义操作对象(Concrete Element的实例)的方法。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Element的抽象类Student-java"><a href="#Element的抽象类Student-java" class="headerlink" title="Element的抽象类Student.java"></a>Element的抽象类Student.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Visitor;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor v)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteElement的实现类GraduateStudent-java"><a href="#ConcreteElement的实现类GraduateStudent-java" class="headerlink" title="ConcreteElement的实现类GraduateStudent.java"></a>ConcreteElement的实现类GraduateStudent.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Visitor;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GraduateStudent</span> <span class="keyword">extends</span> <span class="title">Student</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">double</span> math,english,physics;</div><div class="line">	<span class="keyword">private</span> String name;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">GraduateStudent</span><span class="params">(<span class="keyword">double</span> math, <span class="keyword">double</span> english, <span class="keyword">double</span> physics,</span></span></div><div class="line">			String name) &#123;</div><div class="line">		<span class="keyword">this</span>.math = math;</div><div class="line">		<span class="keyword">this</span>.english = english;</div><div class="line">		<span class="keyword">this</span>.physics = physics;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getMath</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> math;</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getEnglish</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> english;</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPhysics</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> physics;</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor v)</span> </span>&#123;</div><div class="line">		v.visit(<span class="keyword">this</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteElement的实现类Undergraduate-java"><a href="#ConcreteElement的实现类Undergraduate-java" class="headerlink" title="ConcreteElement的实现类Undergraduate.java"></a>ConcreteElement的实现类Undergraduate.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Visitor;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Undergraduate</span> <span class="keyword">extends</span> <span class="title">Student</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">double</span> math,english;</div><div class="line">	<span class="keyword">private</span> String name;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Undergraduate</span><span class="params">(<span class="keyword">double</span> math, <span class="keyword">double</span> english, String name)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.math = math;</div><div class="line">		<span class="keyword">this</span>.english = english;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getMath</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> math;</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getEnglish</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> english;</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Visitor v)</span> </span>&#123;</div><div class="line">		v.visit(<span class="keyword">this</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Visitor的接口类Visitor-java"><a href="#Visitor的接口类Visitor-java" class="headerlink" title="Visitor的接口类Visitor.java"></a>Visitor的接口类Visitor.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Visitor;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Visitor</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(Undergraduate stu)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(GraduateStudent stu)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteVisitor的实现类Company-java"><a href="#ConcreteVisitor的实现类Company-java" class="headerlink" title="ConcreteVisitor的实现类Company.java"></a>ConcreteVisitor的实现类Company.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Visitor;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Company</span> <span class="keyword">implements</span> <span class="title">Visitor</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(Undergraduate stu)</span> </span>&#123;</div><div class="line">		<span class="keyword">double</span> math = stu.getMath();</div><div class="line">		<span class="keyword">double</span> english = stu.getEnglish();</div><div class="line">		<span class="keyword">if</span> (math &gt; <span class="number">80</span> &amp;&amp; english &gt; <span class="number">90</span>) &#123;</div><div class="line">			System.out.println(stu.getName() + <span class="string">"被录用"</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">visit</span><span class="params">(GraduateStudent stu)</span> </span>&#123;</div><div class="line">		<span class="keyword">double</span> math = stu.getMath();</div><div class="line">		<span class="keyword">double</span> english = stu.getEnglish();</div><div class="line">		<span class="keyword">double</span> physics = stu.getPhysics();</div><div class="line">		<span class="keyword">if</span> (math &gt; <span class="number">80</span> &amp;&amp; english &gt; <span class="number">90</span> &amp;&amp; physics &gt; <span class="number">70</span>) &#123;</div><div class="line">			System.out.println(stu.getName() + <span class="string">"被录用"</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Visitor;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Visitor visitor = <span class="keyword">new</span> Company();</div><div class="line">		ArrayList&lt;Student&gt; studentList = <span class="keyword">new</span> ArrayList&lt;Student&gt;();</div><div class="line">		studentList.add(<span class="keyword">new</span> Undergraduate(<span class="number">88</span>, <span class="number">67</span>, <span class="string">"张三"</span>));</div><div class="line">		studentList.add(<span class="keyword">new</span> Undergraduate(<span class="number">90</span>, <span class="number">98</span>, <span class="string">"李四"</span>));</div><div class="line">		studentList.add(<span class="keyword">new</span> Undergraduate(<span class="number">85</span>, <span class="number">92</span>, <span class="string">"王五"</span>));</div><div class="line">		studentList.add(<span class="keyword">new</span> GraduateStudent(<span class="number">88</span>, <span class="number">70</span>, <span class="number">87</span>, <span class="string">"赵六"</span>));</div><div class="line">		studentList.add(<span class="keyword">new</span> GraduateStudent(<span class="number">90</span>, <span class="number">95</span>, <span class="number">82</span>, <span class="string">"周吴"</span>));</div><div class="line">		Iterator&lt;Student&gt; iter = studentList.iterator();</div><div class="line">		<span class="keyword">while</span> (iter.hasNext()) &#123;</div><div class="line">			Student stu = iter.next();</div><div class="line">			stu.accept(visitor);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="执行效果图"><a href="#执行效果图" class="headerlink" title="执行效果图"></a>执行效果图</h1><p><img src="http://i2.buimg.com/4851/5681fc92c4fd1ef2.png" alt=""></p>
<h1 id="双重分派"><a href="#双重分派" class="headerlink" title="双重分派"></a>双重分派</h1><p>访问者模式在不改变类的情况下可有效地增加其上的操作，为了达到这样的效果，使用了一种称为“双重分派”的技术：在访问者模式中，被访问者，即Element角色element，首先调用accept(Visitor visitor)方法接受访问者，而被接受的访问者visitor再调用visit(Element element)方法访问当前对象。</p>
<h1 id="访问者模式的优点"><a href="#访问者模式的优点" class="headerlink" title="访问者模式的优点"></a>访问者模式的优点</h1><ul>
<li>可以在不改变一个集合中元素的类的情况下，增加新的施加于该元素上的新操作。</li>
<li>可以将集合中各个元素的某些操作集中到访问者中，不仅便于集合的维护，也有利于集合中元素的复用。<br>注：在访问者模式中，每增加一个Element角色的子类，都意味着需要在Visitor角色中给出访问该子类的实例的visit()的方法。</li>
</ul>
<h1 id="适用访问者模式的情景"><a href="#适用访问者模式的情景" class="headerlink" title="适用访问者模式的情景"></a>适用访问者模式的情景</h1><ul>
<li>一个对象结构中，比如某个集合中，包含很多对象，想对集合中的对象增加一些新的操作。</li>
<li>需要对集合中的对象进行很多不同的并且不相关的操作，而又不想修改对象的类，就可以使用访问者模式。访问者模式可以在Visitor类中集中定义一些关于集合中对象的操作。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/访问者模式/">访问者模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--解释器模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/14/Java设计模式--解释器模式/" class="article-date">
      <time datetime="2016-09-14T05:03:06.000Z" itemprop="datePublished">2016-09-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/14/Java设计模式--解释器模式/">Java设计模式--解释器模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="解释器模式"><a href="#解释器模式" class="headerlink" title="解释器模式"></a>解释器模式</h1><p>给定一个语言，定义它的文法的一种表示，并定义一个解释器，这个解释器使用该表示来解释语言中的句子。</p>
<h1 id="Interpreter-Pattern"><a href="#Interpreter-Pattern" class="headerlink" title="Interpreter Pattern"></a>Interpreter Pattern</h1><p>Given a language, define a representation for its grammar along with an interpreter that uses the representation to interpret sentences in the language.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://i2.buimg.com/4851/49431bbfc605142f.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>解释器模式的结构中包括四个角色。</p>
<ul>
<li>抽象表达式（AbstractExpression）：该角色为一个接口，负责定义抽象的解释操作。</li>
<li>终结符表达式（TerminalExpression）：实现AbstractExpression接口的类。该类将接口中的解释器操作实现为与文法中的终结符相关联的操作，即文法中的每个终结符需要一个TerminalExpression类。</li>
<li>非终结符表达式（NonterminalExpression）：实现AbstractExpression接口的类。文法中的每一条规则R::=R1R2…Rn都需要一个NonterminalExpression类。NonterminalExpression类为文法中的非终结符号实现解释操作，该解释操作通常使用递归用表示Ri到Rn的那些对象的解释操作。</li>
<li>上下文（Context）：包含解释器之外的一些全局信息。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Node的接口类Dog-java"><a href="#Node的接口类Dog-java" class="headerlink" title="Node的接口类Dog.java"></a>Node的接口类Dog.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Interpreter;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Node</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parse</span><span class="params">(Context text)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Context的类Context-java"><a href="#Context的类Context-java" class="headerlink" title="Context的类Context.java"></a>Context的类Context.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Interpreter;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.StringTokenizer;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</div><div class="line">	StringTokenizer tokenizer;</div><div class="line">	String token;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Context</span><span class="params">(String text)</span> </span>&#123;</div><div class="line">		setContext(text);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContext</span><span class="params">(String text)</span> </span>&#123;</div><div class="line">		tokenizer = <span class="keyword">new</span> StringTokenizer(text);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function">String <span class="title">nextToken</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (tokenizer.hasMoreTokens()) &#123;</div><div class="line">			token = tokenizer.nextToken();</div><div class="line">		&#125; <span class="keyword">else</span> </div><div class="line">			token = <span class="string">""</span>;</div><div class="line">		<span class="keyword">return</span> token;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Node的实现类SubjectPronounOrNounNode-java"><a href="#Node的实现类SubjectPronounOrNounNode-java" class="headerlink" title="Node的实现类SubjectPronounOrNounNode.java"></a>Node的实现类SubjectPronounOrNounNode.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Interpreter;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubjectPronounOrNounNode</span> <span class="keyword">implements</span> <span class="title">Node</span> </span>&#123;</div><div class="line"></div><div class="line">	String[] word = &#123;<span class="string">"You"</span>, <span class="string">"He"</span>, <span class="string">"Teacher"</span>, <span class="string">"Student"</span>&#125;;</div><div class="line">	String token;</div><div class="line">	<span class="keyword">boolean</span> boo;</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parse</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">		token = context.nextToken();</div><div class="line">		<span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (; i &lt; word.length; i++) &#123;</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[i])) &#123;</div><div class="line">				boo = <span class="keyword">true</span>;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (i == word.length) &#123;</div><div class="line">			boo = <span class="keyword">false</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (boo) &#123;</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">0</span>]))</div><div class="line">				System.out.print(<span class="string">"你"</span>);</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">1</span>]))</div><div class="line">				System.out.print(<span class="string">"他"</span>);</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">2</span>]))</div><div class="line">				System.out.print(<span class="string">"老师"</span>);</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">3</span>]))</div><div class="line">				System.out.print(<span class="string">"学生"</span>);</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			System.out.println(token + <span class="string">"(不是该语言中的语句)"</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Node的实现类ObjectPronounOrNounNode-java"><a href="#Node的实现类ObjectPronounOrNounNode-java" class="headerlink" title="Node的实现类ObjectPronounOrNounNode.java"></a>Node的实现类ObjectPronounOrNounNode.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Interpreter;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ObjectPronounOrNounNode</span> <span class="keyword">implements</span> <span class="title">Node</span> </span>&#123;</div><div class="line"></div><div class="line">	String[] word = &#123;<span class="string">"Me"</span>, <span class="string">"Him"</span>, <span class="string">"Tiger"</span>, <span class="string">"Apple"</span>&#125;;</div><div class="line">	String token;</div><div class="line">	<span class="keyword">boolean</span> boo;</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parse</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">		token = context.nextToken();</div><div class="line">		<span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (; i &lt; word.length; i++) &#123;</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[i])) &#123;</div><div class="line">				boo = <span class="keyword">true</span>;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (i == word.length) &#123;</div><div class="line">			boo = <span class="keyword">false</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (boo) &#123;</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">0</span>]))</div><div class="line">				System.out.print(<span class="string">"我"</span>);</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">1</span>]))</div><div class="line">				System.out.print(<span class="string">"他"</span>);</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">2</span>]))</div><div class="line">				System.out.print(<span class="string">"老虎"</span>);</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">3</span>]))</div><div class="line">				System.out.print(<span class="string">"苹果"</span>);</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			System.out.println(token + <span class="string">"(不是该语言中的语句)"</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Node的实现类VerbNode-java"><a href="#Node的实现类VerbNode-java" class="headerlink" title="Node的实现类VerbNode.java"></a>Node的实现类VerbNode.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Interpreter;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VerbNode</span> <span class="keyword">implements</span> <span class="title">Node</span> </span>&#123;</div><div class="line"></div><div class="line">	String[] word = &#123;<span class="string">"Drink"</span>, <span class="string">"Eat"</span>, <span class="string">"Look"</span>, <span class="string">"beat"</span>&#125;;</div><div class="line">	String token;</div><div class="line">	<span class="keyword">boolean</span> boo;</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parse</span><span class="params">(Context context)</span> </span>&#123;</div><div class="line">		token = context.nextToken();</div><div class="line">		<span class="keyword">int</span> i = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (; i &lt; word.length; i++) &#123;</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[i])) &#123;</div><div class="line">				boo = <span class="keyword">true</span>;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (i == word.length) &#123;</div><div class="line">			boo = <span class="keyword">false</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (boo) &#123;</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">0</span>]))</div><div class="line">				System.out.print(<span class="string">"喝"</span>);</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">1</span>]))</div><div class="line">				System.out.print(<span class="string">"吃"</span>);</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">2</span>]))</div><div class="line">				System.out.print(<span class="string">"看"</span>);</div><div class="line">			<span class="keyword">if</span> (token.equalsIgnoreCase(word[<span class="number">3</span>]))</div><div class="line">				System.out.print(<span class="string">"打"</span>);</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			System.out.println(token + <span class="string">"(不是该语言中的语句)"</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Node的实现类SubjectNode-java"><a href="#Node的实现类SubjectNode-java" class="headerlink" title="Node的实现类SubjectNode.java"></a>Node的实现类SubjectNode.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Interpreter;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubjectNode</span> <span class="keyword">implements</span> <span class="title">Node</span> </span>&#123;</div><div class="line"></div><div class="line">	Node node;</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parse</span><span class="params">(Context text)</span> </span>&#123;</div><div class="line">		node = <span class="keyword">new</span> SubjectPronounOrNounNode();</div><div class="line">		node.parse(text);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">		node.execute();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Node的实现类PredicateNode-java"><a href="#Node的实现类PredicateNode-java" class="headerlink" title="Node的实现类PredicateNode.java"></a>Node的实现类PredicateNode.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">papackage Interpreter;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PredicateNode</span> <span class="keyword">implements</span> <span class="title">Node</span> </span>&#123;</div><div class="line"></div><div class="line">	Node verbNode, objectNode;</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parse</span><span class="params">(Context text)</span> </span>&#123;</div><div class="line">		verbNode = <span class="keyword">new</span> VerbNode();</div><div class="line">		objectNode = <span class="keyword">new</span> ObjectPronounOrNounNode();</div><div class="line">		verbNode.parse(text);</div><div class="line">		objectNode.parse(text);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">		verbNode.execute();</div><div class="line">		objectNode.execute();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Node的实现类SentenceNode-java"><a href="#Node的实现类SentenceNode-java" class="headerlink" title="Node的实现类SentenceNode.java"></a>Node的实现类SentenceNode.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Interpreter;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SentenceNode</span> <span class="keyword">implements</span> <span class="title">Node</span> </span>&#123;</div><div class="line"></div><div class="line">	Node subjectNode, predicateNode;</div><div class="line">	</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parse</span><span class="params">(Context text)</span> </span>&#123;</div><div class="line">		subjectNode = <span class="keyword">new</span> SubjectNode();</div><div class="line">		predicateNode = <span class="keyword">new</span> PredicateNode();</div><div class="line">		subjectNode.parse(text);</div><div class="line">		predicateNode.parse(text);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">		subjectNode.execute();</div><div class="line">		predicateNode.execute();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Interpreter;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		String text = <span class="string">"Teacher beat tiger"</span>;</div><div class="line">		Context context = <span class="keyword">new</span> Context(text);</div><div class="line">		Node node = <span class="keyword">new</span> SentenceNode();</div><div class="line">		node.parse(context);</div><div class="line">		node.execute();</div><div class="line">		System.out.println();</div><div class="line">		text = <span class="string">"You eat apple"</span>;</div><div class="line">		context.setContext(text);</div><div class="line">		node.parse(context);</div><div class="line">		node.execute();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h1><p>老师打老虎<br>你吃苹果</p>
<h1 id="解释器模式的优点"><a href="#解释器模式的优点" class="headerlink" title="解释器模式的优点"></a>解释器模式的优点</h1><ul>
<li>将每一个语法规则表示成一个类，方便于实现简单的语言。</li>
<li>由于使用类表示语法规则，可以较容易改变或扩展语言的行为。</li>
<li>通过在类结构中加入新的方法，可以在解释的同时增加新的行为。</li>
</ul>
<h1 id="适用解释器模式的情景"><a href="#适用解释器模式的情景" class="headerlink" title="适用解释器模式的情景"></a>适用解释器模式的情景</h1><ul>
<li>当有一个简单的语言需要解释执行，并且可以将该语言的每一个规则表示为一个类时，就可以使用解释模式。</li>
</ul>
<font color="#0099ff" size="5">注意：如果文法过于复杂，那么过多的文法规则使我们很艰难维护所给出的类。</font>

<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/解释器模式/">解释器模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--备忘录模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/12/Java设计模式--备忘录模式/" class="article-date">
      <time datetime="2016-09-12T11:16:06.000Z" itemprop="datePublished">2016-09-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/12/Java设计模式--备忘录模式/">Java设计模式--备忘录模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="备忘录模式-别名：标记"><a href="#备忘录模式-别名：标记" class="headerlink" title="备忘录模式(别名：标记)"></a>备忘录模式(别名：标记)</h1><p>在不破坏封装性的前提下，捕捉一个对象的内部状态，并在该对象之外保存这个状态，这样以后就可将该对象恢复到原先保存的状态。</p>
<h1 id="Memento-Pattern-Another-Name-Token"><a href="#Memento-Pattern-Another-Name-Token" class="headerlink" title="Memento Pattern(Another Name: Token)"></a>Memento Pattern(Another Name: Token)</h1><p>Without violating encapsulation, capture and externalize an object original state so that the object can be restored to this state later.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://ww1.sinaimg.cn/large/0060lm7Tgw1f7r1l0et5qj30mw09nabl.jpg" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>备忘录模式的结构中包括三种角色。</p>
<ul>
<li>原发者（Originator）：需要在某个时刻保存其状态的对象。原发者负责创建备忘录，比如使用createMemento()方法创建一个备忘录，然后原发者使用该备忘录记录自己的状态。当原发者需要恢复某个时刻的状态时，它通过获得相应备忘录中的数据来恢复那个时刻的状态，比如原发者调用restoreFromMemento(Memento menm)方法，并通过参数mem指定的备忘录恢复状态。</li>
<li>备忘录（Memento）：负责存储原发者状态的对象，创建备忘录的类和创建原发者的类在同一个包中，该类提供的访问数据的方法都是友好方法，使得只有和原发者在同一个包中的类的实例才可以访问备忘录中的数据。</li>
<li>负责人（Caretaker）：负责管理保存备忘录的对象。负责人如果不和原发者在同一个包中，就不能对备忘录中的内容进行修改或读取。如果需要将备忘录保存到磁盘，负责人可以使用对象流将备忘录写入文件。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Memento的备忘录类Memento-java"><a href="#Memento的备忘录类Memento-java" class="headerlink" title="Memento的备忘录类Memento.java"></a>Memento的备忘录类Memento.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Memento;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.Serializable;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Memento</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">long</span> state;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">setPositionState</span><span class="params">(<span class="keyword">long</span> state)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.state = state;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">long</span> <span class="title">getPosition</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> state;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="一个小的工具类ReadPhrase-java"><a href="#一个小的工具类ReadPhrase-java" class="headerlink" title="一个小的工具类ReadPhrase.java"></a>一个小的工具类ReadPhrase.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">ppackage Memento;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.RandomAccessFile;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReadPhrase</span> </span>&#123;</div><div class="line">	<span class="keyword">long</span> readPosition;</div><div class="line">	File file;</div><div class="line">	RandomAccessFile in;</div><div class="line">	String phrase = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ReadPhrase</span><span class="params">(File file)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.file = file;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			in = <span class="keyword">new</span> RandomAccessFile(file, <span class="string">"r"</span>);</div><div class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> Memento <span class="title">createMemento</span><span class="params">()</span> </span>&#123;</div><div class="line">		Memento mem = <span class="keyword">new</span> Memento();</div><div class="line">		System.out.println(<span class="string">"----"</span> + readPosition);</div><div class="line">		mem.setPositionState(readPosition);</div><div class="line">		<span class="keyword">return</span> mem;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">restoreFromMemento</span><span class="params">(Memento mem)</span> </span>&#123;</div><div class="line">		readPosition = mem.getPosition();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">readLine</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			in.seek(readPosition);</div><div class="line">			phrase = in.readLine();</div><div class="line">			<span class="keyword">if</span> (phrase != <span class="keyword">null</span>) &#123;</div><div class="line">				<span class="keyword">byte</span> b[] = phrase.getBytes(<span class="string">"UTF-8"</span>);</div><div class="line">				phrase = <span class="keyword">new</span> String(b);</div><div class="line">			&#125;</div><div class="line">			readPosition = in.getFilePointer();</div><div class="line">			System.out.println(<span class="string">"readPosition:"</span> + readPosition);</div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> phrase;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closeRead</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			in.close();</div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="负责人的类Caretaker-java"><a href="#负责人的类Caretaker-java" class="headerlink" title="负责人的类Caretaker.java"></a>负责人的类Caretaker.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Memento;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.FileOutputStream;</div><div class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</div><div class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Caretaker</span> </span>&#123;</div><div class="line">	File file;</div><div class="line">	<span class="keyword">private</span> Memento memento = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Caretaker</span><span class="params">()</span> </span>&#123;</div><div class="line">		file = <span class="keyword">new</span> File(<span class="string">"saveObject.txt"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> Memento <span class="title">getMemento</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (file.exists()) &#123;</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				FileInputStream in = <span class="keyword">new</span> FileInputStream(<span class="string">"saveObject.txt"</span>);</div><div class="line">				ObjectInputStream inObject = <span class="keyword">new</span> ObjectInputStream(in);</div><div class="line">				memento = (Memento) inObject.readObject();</div><div class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> memento;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveMemento</span><span class="params">(Memento memento)</span> </span>&#123;</div><div class="line">		FileOutputStream out;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			out = <span class="keyword">new</span> FileOutputStream(<span class="string">"D:/09soft/MyEclipse 10/yanning/saveObject.txt"</span>);</div><div class="line">			ObjectOutputStream outObject = <span class="keyword">new</span> ObjectOutputStream(out);</div><div class="line">			outObject.writeObject(memento);</div><div class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Memento;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.RandomAccessFile;</div><div class="line"><span class="keyword">import</span> java.util.Scanner;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Scanner reader = <span class="keyword">new</span> Scanner(System.in);</div><div class="line">		ReadPhrase readPhrase = <span class="keyword">new</span> ReadPhrase(<span class="keyword">new</span> File(<span class="string">"D:/09soft/MyEclipse 10/yanning/src/Memento/phrase.txt"</span>));</div><div class="line">		File favorPhrase = <span class="keyword">new</span> File(<span class="string">"favorPhrase.txt"</span>);</div><div class="line">		RandomAccessFile out = <span class="keyword">null</span>;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			out = <span class="keyword">new</span> RandomAccessFile(favorPhrase, <span class="string">"rw"</span>);</div><div class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		System.out.println(<span class="string">"是否从上次读取的位置继续读取成语(输入y或n)"</span>);</div><div class="line">		String answer = reader.nextLine();</div><div class="line">		<span class="keyword">if</span> (answer.startsWith(<span class="string">"y"</span>)||answer.startsWith(<span class="string">"Y"</span>)) &#123;</div><div class="line">			Caretaker caretaker = <span class="keyword">new</span> Caretaker();   <span class="comment">//创建负责人</span></div><div class="line">			Memento memento = caretaker.getMemento(); <span class="comment">//得到备忘录</span></div><div class="line">			<span class="keyword">if</span> (memento != <span class="keyword">null</span>) &#123;</div><div class="line">				readPhrase.restoreFromMemento(memento);  <span class="comment">//使用备忘录恢复状态</span></div><div class="line">			&#125;</div><div class="line">			String phrase = <span class="keyword">null</span>;</div><div class="line">			<span class="keyword">while</span>((phrase = readPhrase.readLine()) != <span class="keyword">null</span>) &#123;</div><div class="line">				System.out.println(phrase);</div><div class="line">				System.out.println(<span class="string">"是否将该成语保存到"</span> + favorPhrase.getName());</div><div class="line">				answer = reader.nextLine();</div><div class="line">				<span class="keyword">if</span> (answer.startsWith(<span class="string">"y"</span>)||answer.startsWith(<span class="string">"Y"</span>)) &#123;</div><div class="line">					<span class="keyword">try</span> &#123;</div><div class="line">						out.seek(favorPhrase.length());</div><div class="line">						<span class="keyword">byte</span>[] b = phrase.getBytes();</div><div class="line">						out.write(b);</div><div class="line">						out.write(<span class="string">' '</span>);</div><div class="line">					&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">						e.printStackTrace();</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">				System.out.println(<span class="string">"是否继续读取成语?(输入y或n)"</span>);</div><div class="line">				answer = reader.nextLine();</div><div class="line">				<span class="keyword">if</span> (answer.startsWith(<span class="string">"y"</span>)||answer.startsWith(<span class="string">"Y"</span>)) &#123;</div><div class="line">					<span class="keyword">continue</span>;</div><div class="line">				&#125; <span class="keyword">else</span> &#123;</div><div class="line">					readPhrase.closeRead();</div><div class="line">					caretaker.saveMemento(readPhrase.createMemento());</div><div class="line">					<span class="keyword">try</span> &#123;</div><div class="line">						out.close();</div><div class="line">					&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">						e.printStackTrace();</div><div class="line">					&#125;</div><div class="line">					System.exit(<span class="number">0</span>);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			System.out.println(<span class="string">"读完全部成语"</span>);</div><div class="line">		&#125;</div><div class="line">		System.exit(<span class="number">0</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="备忘录模式的优点"><a href="#备忘录模式的优点" class="headerlink" title="备忘录模式的优点"></a>备忘录模式的优点</h1><ul>
<li>备忘录模式使用备忘录可以把原发者的内部状态保存起来，使只有很“亲密的”的对象可以访问备忘录中的数据。</li>
<li>备忘录模式强调了类设计单一责任原则，即将状态的刻画和保存分开。</li>
</ul>
<h1 id="适用备忘录模式的情景"><a href="#适用备忘录模式的情景" class="headerlink" title="适用备忘录模式的情景"></a>适用备忘录模式的情景</h1><h2 id="下列情况之一就可以考虑使用备忘录模式"><a href="#下列情况之一就可以考虑使用备忘录模式" class="headerlink" title="下列情况之一就可以考虑使用备忘录模式"></a>下列情况之一就可以考虑使用备忘录模式</h2><ul>
<li>必须保存一个对象在某一时刻的全部或部分状态，以便在需要时恢复该对象先前的状态。</li>
<li>一个对象不想通过提供public权限的，诸如getXXX()的方法让其他对象得到自己的内部状态。</li>
</ul>
<p>注：如果备忘录需要存储大量的数据或非常频繁地创建备忘录，可能会导致非常大的存储开销。</p>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/备忘录模式/">备忘录模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--享元模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/12/Java设计模式--享元模式/" class="article-date">
      <time datetime="2016-09-12T00:07:06.000Z" itemprop="datePublished">2016-09-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/12/Java设计模式--享元模式/">Java设计模式--享元模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="享元模式"><a href="#享元模式" class="headerlink" title="享元模式"></a>享元模式</h1><p>运用共享技术有效的支持<font color="#0099ff" size="5">大量细粒度</font>的对象。</p>
<h1 id="Flyweight-Pattern"><a href="#Flyweight-Pattern" class="headerlink" title="Flyweight Pattern"></a>Flyweight Pattern</h1><p>Use sharing to support large numbers of fine-grained objects efficiently.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://ww4.sinaimg.cn/large/0060lm7Tgw1f7qtadbknjj30hk08tjsc.jpg" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>享元方法模式的结构中包括三种角色。</p>
<ul>
<li>享元接口（Flyweight）：是一个接口，该接口定义了享元对外公开其内部数据的方法，以及享元接收外部数据的方法。</li>
<li>具体享元（Concrete Flyweight）：实现享元接口的类，该类的实例称为享元对象，或简称享元。具体享元类的成员变量为享元对象的内部状态，享元对象的内部状态必须与所处的周围环境无关，即要保证使用享元对象的应用程序无法更改享元的内部状态，只有这样才能使得享元对象在系统中被共享。因为享元对象是用来共享的，所以不能允许用户各自地使用具体享元类来创建对象，这样就无法达到共享的目的，因为不同用户用具体享元类创建的对象显然是不同的，所以，具体享元类的构造方法必须是private的，其目的是不允许用户程序直接使用具体享元类来创建享元对象，创建和管理享元对象由享元工厂负责。</li>
<li>享元工厂（Flyweight Factory）：享元工厂是一个类，该类的实例负责创建和管理享元对象，用户或其他对象必须请求享元工厂为它得到一个享元对象。享元工厂可以通过一个散列表（也称共享池）来管理享元对象，当用户程序或其他若干个对象向享元工厂请求一个享元对象时，如果享元工厂的散列表中已有这样的享元对象，享元工厂就提供这个享元对象给请求者，否则就创建一个享元对象添加到散列表中，同时该享元对象提供给请求者。显然，当若干个用户或对象请求享元工厂提供一个享元对象时，第一个用户获得该享元对象的时间可能慢一些，但是后继的用户会较快地获得这个享元对象。可以使用单例模式来设计享元工厂，即让系统中只有一个享元工厂的实例。另外，为了让享元工厂能生成享元对象，需要将具体享元类作为享元工厂的内部类。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Flyweight的抽象类Flyweight-java"><a href="#Flyweight的抽象类Flyweight-java" class="headerlink" title="Flyweight的抽象类Flyweight.java"></a>Flyweight的抽象类Flyweight.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Flyweight;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Flyweight</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getHeight</span><span class="params">()</span></span>;      <span class="comment">//返回内部数据</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getWidth</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getLength</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printMess</span><span class="params">(String mess)</span></span>;  <span class="comment">//使用参数mess获取外部数据</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Flyweight-Factory的实现类FlyweightFactory-java"><a href="#Flyweight-Factory的实现类FlyweightFactory-java" class="headerlink" title="Flyweight Factory的实现类FlyweightFactory.java"></a>Flyweight Factory的实现类FlyweightFactory.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Flyweight;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyweightFactory</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> HashMap&lt;String, Flyweight&gt; hashMap;</div><div class="line">	<span class="keyword">static</span> FlyweightFactory factory = <span class="keyword">new</span> FlyweightFactory();</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">FlyweightFactory</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.hashMap = <span class="keyword">new</span> HashMap&lt;String, Flyweight&gt;();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> FlyweightFactory <span class="title">getFactory</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> factory;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> Flyweight <span class="title">getFlyweight</span><span class="params">(String key)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (hashMap.containsKey(key)) &#123;</div><div class="line">			<span class="keyword">return</span> hashMap.get(key);</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			<span class="keyword">double</span> width = <span class="number">0</span>,height = <span class="number">0</span>,lenght = <span class="number">0</span>;</div><div class="line">			String[] str = key.split(<span class="string">"#"</span>);</div><div class="line">			width = Double.parseDouble(str[<span class="number">0</span>]);</div><div class="line">			height = Double.parseDouble(str[<span class="number">1</span>]);</div><div class="line">			lenght = Double.parseDouble(str[<span class="number">2</span>]);</div><div class="line">			Flyweight ft = <span class="keyword">new</span> ConcreteFlyweight(width, height, lenght);</div><div class="line">			hashMap.put(key, ft);</div><div class="line">			<span class="keyword">return</span> ft;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="class"><span class="keyword">class</span> <span class="title">ConcreteFlyweight</span> <span class="keyword">implements</span> <span class="title">Flyweight</span> </span>&#123;</div><div class="line"></div><div class="line">		<span class="keyword">private</span> <span class="keyword">double</span> width;</div><div class="line">		<span class="keyword">private</span> <span class="keyword">double</span> height;</div><div class="line">		<span class="keyword">private</span> <span class="keyword">double</span> lenght;</div><div class="line">		</div><div class="line">		</div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="title">ConcreteFlyweight</span><span class="params">(<span class="keyword">double</span> width, <span class="keyword">double</span> height, <span class="keyword">double</span> lenght)</span> </span>&#123;</div><div class="line">			<span class="keyword">this</span>.width = width;</div><div class="line">			<span class="keyword">this</span>.height = height;</div><div class="line">			<span class="keyword">this</span>.lenght = lenght;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getHeight</span><span class="params">()</span> </span>&#123;</div><div class="line">			<span class="keyword">return</span> height;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getWidth</span><span class="params">()</span> </span>&#123;</div><div class="line">			<span class="keyword">return</span> width;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getLength</span><span class="params">()</span> </span>&#123;</div><div class="line">			<span class="keyword">return</span> lenght;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="meta">@Override</span></div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printMess</span><span class="params">(String mess)</span> </span>&#123;</div><div class="line">			System.out.println(mess);</div><div class="line">			System.out.print(<span class="string">"宽度:"</span> + width);</div><div class="line">			System.out.print(<span class="string">"高度:"</span> + height);</div><div class="line">			System.out.print(<span class="string">"长度:"</span> + lenght);</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="需要使用共享数据的类Car-java"><a href="#需要使用共享数据的类Car-java" class="headerlink" title="需要使用共享数据的类Car.java"></a>需要使用共享数据的类Car.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Flyweight;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</div><div class="line">	Flyweight flyweight;</div><div class="line">	String name, color;</div><div class="line">	<span class="keyword">int</span> power;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Car</span><span class="params">(Flyweight flyweight, String name, String color, <span class="keyword">int</span> power)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.flyweight = flyweight;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">		<span class="keyword">this</span>.color = color;</div><div class="line">		<span class="keyword">this</span>.power = power;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</div><div class="line">		System.out.println(<span class="string">"名称:"</span> + name);</div><div class="line">		System.out.println(<span class="string">"颜色:"</span> + color);</div><div class="line">		System.out.println(<span class="string">"功率:"</span> + power);</div><div class="line">		System.out.println(<span class="string">"宽度:"</span> + flyweight.getWidth());</div><div class="line">		System.out.println(<span class="string">"高度:"</span> + flyweight.getHeight());</div><div class="line">		System.out.println(<span class="string">"长度:"</span> + flyweight.getLength());</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Flyweight;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		FlyweightFactory factory = FlyweightFactory.getFactory();</div><div class="line">		<span class="keyword">double</span> width = <span class="number">1.82</span>, height = <span class="number">1.47</span>, lenght = <span class="number">5.12</span>;</div><div class="line">		String key = <span class="string">""</span> + width + <span class="string">"#"</span> + height + <span class="string">"#"</span> + lenght;</div><div class="line">		Flyweight flyweight = factory.getFlyweight(key);</div><div class="line">		Car audiA60ne = <span class="keyword">new</span> Car(flyweight, <span class="string">"奥迪A6"</span>, <span class="string">"黑色"</span>, <span class="number">128</span>);</div><div class="line">		Car audiA6Two = <span class="keyword">new</span> Car(flyweight, <span class="string">"奥迪A6"</span>, <span class="string">"灰色"</span>, <span class="number">160</span>);</div><div class="line">		<span class="comment">//audiA60ne和audiA6Two没有向享元传递外部数据，而是获取享元的内部数据</span></div><div class="line">		audiA60ne.print();</div><div class="line">		audiA6Two.print();</div><div class="line">		width = <span class="number">1.77</span>;</div><div class="line">		height = <span class="number">1.45</span>;</div><div class="line">		lenght = <span class="number">4.63</span>;</div><div class="line">		key = <span class="string">""</span> + width + <span class="string">"#"</span> + height + <span class="string">"#"</span> + lenght;</div><div class="line">		Car audiA40ne = <span class="keyword">new</span> Car(flyweight, <span class="string">"奥迪A4"</span>, <span class="string">"蓝色"</span>, <span class="number">126</span>);</div><div class="line">		Car audiA4Two = <span class="keyword">new</span> Car(flyweight, <span class="string">"奥迪A4"</span>, <span class="string">"红色"</span>, <span class="number">138</span>);</div><div class="line">		<span class="comment">//audiA40ne和audiA4Two向享元传递外部数据，这些数据是不共享的</span></div><div class="line">		flyweight.printMess(<span class="string">"名称: 奥迪A4 颜色：蓝色 功率：126"</span>);</div><div class="line">		flyweight.printMess(<span class="string">"名称: 奥迪A4 颜色：红色 功率：138"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="执行结果"><a href="#执行结果" class="headerlink" title="执行结果"></a>执行结果</h1><p><img src="http://ww1.sinaimg.cn/large/0060lm7Tgw1f7qyhb79v8j30hf0agdha.jpg" alt=""></p>
<h1 id="享元模式的优点"><a href="#享元模式的优点" class="headerlink" title="享元模式的优点"></a>享元模式的优点</h1><ul>
<li>使用享元模式可以节省内存的开销，特别适合处理<font color="#0099ff" size="5">大量细粒度</font>对象，这些对象的许多属性值是相同的，而且一旦创建则不容许修改。</li>
<li>享元模式中的享元可以使用方法的参数接收外部状态中的数据，但外部状态数据不会干扰到享元中的内部数据，这就使享元可以在不同的环境中被共享。</li>
</ul>
<h1 id="适用享元模式的情景"><a href="#适用享元模式的情景" class="headerlink" title="适用享元模式的情景"></a>适用享元模式的情景</h1><h2 id="下列情况之一就可以考虑使用享元模式"><a href="#下列情况之一就可以考虑使用享元模式" class="headerlink" title="下列情况之一就可以考虑使用享元模式:"></a>下列情况之一就可以考虑使用享元模式:</h2><ul>
<li>一个应用程序使用大量的对象，这些对象之间部分属性本质上是相同的，这时应使用享元来封装相同的部分。</li>
<li>对象的多数状态都可变为外部状态，就可以考虑将这些对象作为系统中的享元来使用。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/享元模式/">享元模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--状态模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/11/Java设计模式--状态模式/" class="article-date">
      <time datetime="2016-09-11T09:11:06.000Z" itemprop="datePublished">2016-09-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/11/Java设计模式--状态模式/">Java设计模式--状态模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="状态模式-别名：状态对象"><a href="#状态模式-别名：状态对象" class="headerlink" title="状态模式(别名：状态对象)"></a>状态模式(别名：状态对象)</h1><p>允许一个对象在其内部状态改变时改变它的行为，对象看起来似乎修改了它的类。</p>
<h1 id="State-Pattern-Another-Name-Object-for-States"><a href="#State-Pattern-Another-Name-Object-for-States" class="headerlink" title="State Pattern(Another Name: Object for States)"></a>State Pattern(Another Name: Object for States)</h1><p>Allow an object to alert its behavior when its internal state changes. The object will appear to change its class.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://i1.piimg.com/4851/e382db55a3582634.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>状态模式的结构中包括三种角色。</p>
<ul>
<li>环境（Context）：环境是一个类，该类含有抽象状态（State）声明的变量，可以引用任何具体状态类的实例。用户对该环境（Context）类的实例在某种状态下的行为感兴趣。</li>
<li>抽象状态（State）：抽象状态是一个接口或抽象类。抽象状态中定义了与环境（Context）的一个特定状态相关的如果个方法。</li>
<li>具体状态（Concrete State）：具体状态是实现（扩展）抽象状态（抽象类）的类。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="State的接口类TemperatureState-java"><a href="#State的接口类TemperatureState-java" class="headerlink" title="State的接口类TemperatureState.java"></a>State的接口类TemperatureState.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> State;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TemperatureState</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showTemperature</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Context环境类Thermometer-java"><a href="#Context环境类Thermometer-java" class="headerlink" title="Context环境类Thermometer.java"></a>Context环境类Thermometer.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> State;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thermometer</span> </span>&#123;</div><div class="line">	TemperatureState state;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showMessage</span><span class="params">()</span> </span>&#123;</div><div class="line">		System.out.println(<span class="string">"*************"</span>);</div><div class="line">		state.showTemperature();</div><div class="line">		System.out.println(<span class="string">"*************"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(TemperatureState state)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.state = state;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteState的实现类LowState-java"><a href="#ConcreteState的实现类LowState-java" class="headerlink" title="ConcreteState的实现类LowState.java"></a>ConcreteState的实现类LowState.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> State;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LowState</span> <span class="keyword">implements</span> <span class="title">TemperatureState</span> </span>&#123;</div><div class="line">	<span class="keyword">double</span> n = <span class="number">0</span>;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">LowState</span><span class="params">(<span class="keyword">double</span> n)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</div><div class="line">			<span class="keyword">this</span>.n = n;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showTemperature</span><span class="params">()</span> </span>&#123;</div><div class="line">		System.out.println(<span class="string">"现在的温度是"</span> + n + <span class="string">"属于低温度"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteState的实现类MiddleState-java"><a href="#ConcreteState的实现类MiddleState-java" class="headerlink" title="ConcreteState的实现类MiddleState.java"></a>ConcreteState的实现类MiddleState.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> State;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MiddleState</span> <span class="keyword">implements</span> <span class="title">TemperatureState</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">double</span> n = <span class="number">15</span>;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MiddleState</span><span class="params">(<span class="keyword">double</span> n)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (n &gt; <span class="number">0</span> &amp;&amp; n &lt; <span class="number">26</span>) &#123;</div><div class="line">			<span class="keyword">this</span>.n = n;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showTemperature</span><span class="params">()</span> </span>&#123;</div><div class="line">		System.out.println(<span class="string">"现在的温度是"</span> + n + <span class="string">"属于正常温度"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteState的实现类HighState-java"><a href="#ConcreteState的实现类HighState-java" class="headerlink" title="ConcreteState的实现类HighState..java"></a>ConcreteState的实现类HighState..java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> State;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HighState</span> <span class="keyword">implements</span> <span class="title">TemperatureState</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">double</span> n = <span class="number">39</span>;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">HighState</span><span class="params">(<span class="keyword">double</span> n)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (n &gt; <span class="number">26</span>) &#123;</div><div class="line">			<span class="keyword">this</span>.n = n;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showTemperature</span><span class="params">()</span> </span>&#123;</div><div class="line">		System.out.println(<span class="string">"现在的温度是"</span> + n + <span class="string">"属于高温"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> State;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		TemperatureState state = <span class="keyword">new</span> LowState(-<span class="number">12</span>);</div><div class="line">		Thermometer thermometer = <span class="keyword">new</span> Thermometer();</div><div class="line">		thermometer.setState(state);</div><div class="line">		thermometer.showMessage();</div><div class="line">		state = <span class="keyword">new</span> MiddleState(<span class="number">15</span>);</div><div class="line">		thermometer.setState(state);</div><div class="line">		thermometer.showMessage();</div><div class="line">		state = <span class="keyword">new</span> HighState(<span class="number">40</span>);</div><div class="line">		thermometer.setState(state);</div><div class="line">		thermometer.showMessage();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="状态模式的优点"><a href="#状态模式的优点" class="headerlink" title="状态模式的优点"></a>状态模式的优点</h1><ul>
<li>使用一个类封装对象的一种状态，很容易增加新的状态。</li>
<li>在状态模式中，环境（Context）中不必出现大量的条件判断语句。环境（Context）实例所呈现的状态变得更加清晰、容易理解。</li>
<li>使用状态模式可以让用户程序很方便地切换环境（Context）实例的状态。</li>
<li>使用状态模式不会让环境（Context）的实例中出现内部状态不一致的情况。</li>
<li>当状态对象没有实例变量时，环境（Context）的各个实例可以共享一个状态对象。</li>
</ul>
<h1 id="适用状态模式的情景"><a href="#适用状态模式的情景" class="headerlink" title="适用状态模式的情景"></a>适用状态模式的情景</h1><ul>
<li>一个对象的行为依赖于它的状态，并且它必须在运行时根据状态改变它的行为。</li>
<li>需要编写大量的条件分支语句来决定一个操作的行为，而且这些条件恰好表示对象的一种状态。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/状态模式/">状态模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--责任链模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/11/Java设计模式--责任链模式/" class="article-date">
      <time datetime="2016-09-11T02:19:06.000Z" itemprop="datePublished">2016-09-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/11/Java设计模式--责任链模式/">Java设计模式--责任链模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="责任链模式"><a href="#责任链模式" class="headerlink" title="责任链模式"></a>责任链模式</h1><p>使多个对象都有机会都有机会处理请求，从而避免请求的发送者和接受者之间的耦合关系。将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它为止。</p>
<h1 id="Chain-of-Responsibility-Pattern"><a href="#Chain-of-Responsibility-Pattern" class="headerlink" title="Chain of Responsibility Pattern"></a>Chain of Responsibility Pattern</h1><p>A void coupling the sender of a request to its receiver by giving more than one object a chance to handle the request. Chain the receiving objects and pass the request along the chain until an object handles it.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://i1.piimg.com/4851/46acb4ac8f093e1a.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>责任链模式的结构中包括两种角色。</p>
<ul>
<li>处理者（Handler）：处理者是一个接口，负责规定具体处理者处理用户请求的方法以及具体处理者设置后继对象的方法。</li>
<li>具体处理者（Concrete Handler）：具体处理者是实现处理者的类的实例。具体处理者通过调用处理者接口规定的方法处理用户的请求，即在接到用户的请求后，处理者将调用接口规定的方法，在执行该方法的过程中，如果发现能处理用户的请求，就处理有关数据，否则就反馈无法处理的信息给用户，然后将用户的请求传递给自己的后继对象。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Handler的抽象类Handler-java"><a href="#Handler的抽象类Handler-java" class="headerlink" title="Handler的抽象类Handler.java"></a>Handler的抽象类Handler.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Handler;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Handler</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String number)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">setHandler</span><span class="params">(Handler handler)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteHandler的实现类Beijing-java"><a href="#ConcreteHandler的实现类Beijing-java" class="headerlink" title="ConcreteHandler的实现类Beijing.java"></a>ConcreteHandler的实现类Beijing.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Handler;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Beijing</span> <span class="keyword">implements</span> <span class="title">Handler</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> Handler handler;</div><div class="line">	<span class="keyword">private</span> ArrayList&lt;String&gt; numberList;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Beijing</span><span class="params">()</span> </span>&#123;</div><div class="line">		numberList = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">		numberList.add(<span class="string">"11029812340930034"</span>);</div><div class="line">		numberList.add(<span class="string">"11029812340930033"</span>);</div><div class="line">		numberList.add(<span class="string">"11029812340930032"</span>);</div><div class="line">		numberList.add(<span class="string">"11029812340930031"</span>);</div><div class="line">		numberList.add(<span class="string">"11029812340930030"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String number)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (numberList.contains(number)) &#123;</div><div class="line">			System.out.println(<span class="string">"该人在北京住"</span>);</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			System.out.println(<span class="string">"该人不在北京住"</span>);</div><div class="line">			<span class="keyword">if</span> (handler!=<span class="keyword">null</span>) &#123;</div><div class="line">				handler.handleRequest(number);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHandler</span><span class="params">(Handler handler)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.handler = handler;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteHandler的实现类Shanghai-java"><a href="#ConcreteHandler的实现类Shanghai-java" class="headerlink" title="ConcreteHandler的实现类Shanghai.java"></a>ConcreteHandler的实现类Shanghai.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Handler;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Shanghai</span> <span class="keyword">implements</span> <span class="title">Handler</span> </span>&#123;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> Handler handler;</div><div class="line">	<span class="keyword">private</span> ArrayList&lt;String&gt; numberList;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Shanghai</span><span class="params">()</span> </span>&#123;</div><div class="line">		numberList = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">		numberList.add(<span class="string">"12029812340930034"</span>);</div><div class="line">		numberList.add(<span class="string">"12029812340930033"</span>);</div><div class="line">		numberList.add(<span class="string">"12029812340930032"</span>);</div><div class="line">		numberList.add(<span class="string">"12029812340930031"</span>);</div><div class="line">		numberList.add(<span class="string">"12029812340930030"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(String number)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (numberList.contains(number)) &#123;</div><div class="line">			System.out.println(<span class="string">"该人住在上海"</span>);</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			System.out.println(<span class="string">"该人不住在上海"</span>);</div><div class="line">			<span class="keyword">if</span> (handler!=<span class="keyword">null</span>) &#123;</div><div class="line">				handler.handleRequest(number);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHandler</span><span class="params">(Handler handler)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.handler = handler;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Handler;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> Handler beijing,shanghai;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createChain</span><span class="params">()</span> </span>&#123;</div><div class="line">		beijing = <span class="keyword">new</span> Beijing();</div><div class="line">		shanghai = <span class="keyword">new</span> Shanghai();</div><div class="line">		beijing.setHandler(shanghai);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reponseClient</span><span class="params">(String number)</span> </span>&#123;</div><div class="line">		beijing.handleRequest(number);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Application application = <span class="keyword">new</span> Application();</div><div class="line">		application.createChain();</div><div class="line">		application.reponseClient(<span class="string">"12029812340930034"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="责任链模式的优点"><a href="#责任链模式的优点" class="headerlink" title="责任链模式的优点"></a>责任链模式的优点</h1><ul>
<li>责任链中的对象只和自己的后继是低耦合关系，和其他对象毫无关联，这使得编写处理者对象以及创建责任链变得非常容易。</li>
<li>当在处理者中分配职责时，责任链给应用程序更多的灵活性。</li>
<li>应用程序可以动态地增加、删除处理者或重新指派处理者的职责。</li>
<li>应用程序可以动态地改变处理者之间的先后顺序。</li>
<li>使用责任链的用户不必知道处理者的信息，用户不会知道到底是哪个对象处理了它的请求。</li>
</ul>
<h1 id="适用责任链模式的情景"><a href="#适用责任链模式的情景" class="headerlink" title="适用责任链模式的情景"></a>适用责任链模式的情景</h1><ul>
<li>有许多对象可以处理用户的请求，希望程序在运行期间自动确定处理用户的那个对象。</li>
<li>希望用户不必明确指定接受者的情况下，向多个接受者的一个提交请求。</li>
<li>程序希望动态制定可处理用户请求的对象集合。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/责任链模式/">责任链模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2016 yxx
            </div>
            <div class="footer-right">
                <a href="https://androidwolf.github.io/" target="_blank" title="叶显秀的Github">yxx@版权所有，翻版绝对不究</a>
            </div>
        </div>
        <div class="visit">
            <span id="busuanzi_container_site_pv" style='display:none'>
                <span id="site-visit" >本站到访数: 
                    <span id="busuanzi_value_site_uv"></span>
                </span>
            </span>
            <span id="busuanzi_container_page_pv" style='display:none'>
                <span id="page-visit">, 本页阅读量: 
                    <span id="busuanzi_value_page_pv"></span>
                </span>
            </span>
        </div>
    </div>
</footer>
    </div>
    
    <script>
        var yiliaConfig = {
            fancybox: false,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
        }
    </script>


<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>