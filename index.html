<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>起今知行 | 跨越者</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="爱长腹肌，爱学习的秀秀">
<meta property="og:type" content="website">
<meta property="og:title" content="起今知行 | 跨越者">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="起今知行 | 跨越者">
<meta property="og:description" content="爱长腹肌，爱学习的秀秀">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="起今知行 | 跨越者">
<meta name="twitter:description" content="爱长腹肌，爱学习的秀秀">
  
    <link rel="alternative" href="/atom.xml" title="起今知行 | 跨越者" type="application/atom+xml">
  
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/me.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">yxx</a></h1>
        </hgroup>

        
        <p class="header-subtitle">知我者谓我心忧，不知我者谓我何求</p>
        
        
        <form><input type="text" class="search" placeholder=" Search..."></form>
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="#" title="Email"></a></li>
                            
                                <li id="新浪微博"><a class="新浪微博" target="_blank" href="/weibo" title="新浪微博"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="/GitHub" title="GitHub"></a></li>
                            
                                <li id="微信"><a class="微信" target="_blank" href="/Wechat" title="微信"></a></li>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/personal/" style="font-size: 10px;">personal</a> <a href="/tags/中介者模式/" style="font-size: 10px;">中介者模式</a> <a href="/tags/享元模式/" style="font-size: 10px;">享元模式</a> <a href="/tags/代理模式/" style="font-size: 10px;">代理模式</a> <a href="/tags/单例模式/" style="font-size: 10px;">单例模式</a> <a href="/tags/原型模式/" style="font-size: 10px;">原型模式</a> <a href="/tags/命令模式/" style="font-size: 10px;">命令模式</a> <a href="/tags/备忘录模式/" style="font-size: 10px;">备忘录模式</a> <a href="/tags/外观模式/" style="font-size: 10px;">外观模式</a> <a href="/tags/工厂模式/" style="font-size: 10px;">工厂模式</a> <a href="/tags/总结/" style="font-size: 10px;">总结</a> <a href="/tags/抽象工厂模式/" style="font-size: 10px;">抽象工厂模式</a> <a href="/tags/桥接模式/" style="font-size: 10px;">桥接模式</a> <a href="/tags/模板方法模式/" style="font-size: 10px;">模板方法模式</a> <a href="/tags/状态模式/" style="font-size: 10px;">状态模式</a> <a href="/tags/生成器模式/" style="font-size: 10px;">生成器模式</a> <a href="/tags/策略模式/" style="font-size: 10px;">策略模式</a> <a href="/tags/组合模式/" style="font-size: 10px;">组合模式</a> <a href="/tags/装饰模式/" style="font-size: 10px;">装饰模式</a> <a href="/tags/观察者模式/" style="font-size: 10px;">观察者模式</a> <a href="/tags/解释器模式/" style="font-size: 10px;">解释器模式</a> <a href="/tags/设计模式/" style="font-size: 20px;">设计模式</a> <a href="/tags/访问者模式/" style="font-size: 10px;">访问者模式</a> <a href="/tags/责任链模式/" style="font-size: 10px;">责任链模式</a> <a href="/tags/适配器模式/" style="font-size: 10px;">适配器模式</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://androidwolf.github.io/">Me</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/androidwolf">GitHub</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/bug_moving">CSND</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">爱谈天跨地的秀秀</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">yxx</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img lazy-src="/img/me.jpg" class="js-avatar">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">yxx</a></h1>
            </hgroup>
            
            <p class="header-subtitle">知我者谓我心忧，不知我者谓我何求</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="#" title="Email"></a></li>
                            
                                <li id="新浪微博"><a class="新浪微博" target="_blank" href="/weibo" title="新浪微博"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="/GitHub" title="GitHub"></a></li>
                            
                                <li id="微信"><a class="微信" target="_blank" href="/Wechat" title="微信"></a></li>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-设计模式总结" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/25/设计模式总结/" class="article-date">
      <time datetime="2016-09-25T02:01:06.000Z" itemprop="datePublished">2016-09-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/25/设计模式总结/">Java设计模式--总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>设计模式是从许多优秀的软件系统中总结出成功的可复用的设计方案。设计模式一定是将简单的东西复杂化，哈哈哈，是不是矛盾，其实不然，扩展性大大增强。</p>
<h1 id="什么是框架"><a href="#什么是框架" class="headerlink" title="什么是框架"></a>什么是框架</h1><p>框架不是模式，框架是针对某个领域，提供用于开发应用系统的类的集合，程序设计者可以使用框架提供的类设计一个应用程序，而且在设计应用程序时可以针对特定的问题使用某个模式。<br>1.层次不同。模式比框架更抽象，模式是在某种特定环境中，针对一个软件设计出现的问题而给出的可复用的解决方案，不能向使用者提供可以直接使用的类，设计模式只有在被设计人员使用时才能表示为代码。框架和模式不同，它不是一种可复用的设计方案，它是由可用于设计解决某个问题的一些类组成的集合，程序设计人员通过使用框架提供的类或扩展框架提供的类进行应用程序的设计。<br>2.范围不同。模式本质上是逻辑概念，以概念的形式而存在，模式所描述的方案独立于编程语言。框架的应用很具体，它们不是以概念的形式而存在，而是以具体的软件组织而存在。<br>3.相互关系。一个框架往往包括很多个设计模式，它们是面向对象系统获得最大复用的方式，较大的面向对象应用会由多层彼此合作的框架组成。</p>
<h1 id="面向对象的基本原则"><a href="#面向对象的基本原则" class="headerlink" title="面向对象的基本原则"></a>面向对象的基本原则</h1><h2 id="面向抽象原则"><a href="#面向抽象原则" class="headerlink" title="面向抽象原则"></a>面向抽象原则</h2><h3 id="抽象类和接口"><a href="#抽象类和接口" class="headerlink" title="抽象类和接口"></a>抽象类和接口</h3><p>1.抽象类<br>抽象类具有如下特点：</p>
<ul>
<li>抽象类中可以有abstract方法，也可以有非abstract方法。</li>
<li>抽象类不能用new运算符创建对象。</li>
<li>如果一个非抽象类是某个抽象类的子类，那么它必须重写父类的abstract方法。</li>
<li>作为上转型对象。其实就是子类对象指向父类引用。</li>
</ul>
<p>2.接口<br>接口具有如下特点：</p>
<ul>
<li>接口中只可以有public权限的abstract方法，不能有非abstract方法。</li>
<li>接口由类去实现，实现全部方法。</li>
<li>接口回调。其实就是子类对象指向父类引用。</li>
</ul>
<h3 id="面向抽象"><a href="#面向抽象" class="headerlink" title="面向抽象"></a>面向抽象</h3><p>所谓面向抽象编程，是指当设计一个类时，不让该类面向具体的类，而是面向抽象类或接口，即所设计类中的重要数据是抽象类或接口声明的变量。</p>
<h2 id="开-闭原则"><a href="#开-闭原则" class="headerlink" title="开-闭原则"></a>开-闭原则</h2><p>所谓“开-闭原则”（Open-Closed Principle）就是让设计对扩展开放，对修改关闭。实际上这句话的本质就是指当一个设计中增加新的模块时，不需要修改现有的模块。</p>
<h2 id="多用组合少用继承原则"><a href="#多用组合少用继承原则" class="headerlink" title="多用组合少用继承原则"></a>多用组合少用继承原则</h2><p>之所以提倡多用组合，少用继承，是因为在许多设计中，人们希望系统的类之间尽量是低耦合的关系，而不希望是强耦合关系。即在许多情况下需要避开继承的缺点，而需要组合的优点。在装饰模式，策略模式以及中介者模式中都有体现。</p>
<h2 id="高内聚-低耦合原则"><a href="#高内聚-低耦合原则" class="headerlink" title="高内聚-低耦合原则"></a>高内聚-低耦合原则</h2><p>如果类中的方法是一组相关的行为，则称该类时高内聚的，反之称为低内聚的。高内聚便于维护，而低内聚不利于类的维护。</p>
<h1 id="创建型模式"><a href="#创建型模式" class="headerlink" title="创建型模式"></a>创建型模式</h1><p>创建型模式涉及对象的实例化，这类模式的特点是，不让用户代码依赖于对象的创建或排列方式，避免用户直接使用new运算符创建对象。</p>
<h2 id="GOF的23中模式中的下列5种模式是属于创建型的模式"><a href="#GOF的23中模式中的下列5种模式是属于创建型的模式" class="headerlink" title="GOF的23中模式中的下列5种模式是属于创建型的模式"></a>GOF的23中模式中的下列5种模式是属于创建型的模式</h2><ul>
<li>工厂方法模式：定义了一个用于创建对象的接口，让子类决定实例化哪一个类。Factory Method使一个类的实例化延迟到其子类。</li>
<li>抽象工厂模式：提供一个创建一系列或相互依赖对象的接口，而无须制定它们具体的类。</li>
<li>生成器模式：将一个复杂对象的创建于它的表示分离，使得同样的构建过程可以创建不同的表示。</li>
<li>原型模式：用原型实例制定创建对象的种类，并且通过复制这些原型创建新的对象。</li>
<li>单件模式：保证一个类仅有一个实例，并提供一个访问它的全局访问点。</li>
</ul>
<h1 id="行为型模式"><a href="#行为型模式" class="headerlink" title="行为型模式"></a>行为型模式</h1><p>行为型模式涉及怎样合理地涉及对象之间的交互通信，以及怎样合理为对象分配职责，让设计富有弹性，易维护，易复用。</p>
<h2 id="GOF的23中模式中的下列11种模式是属于创建型模式。"><a href="#GOF的23中模式中的下列11种模式是属于创建型模式。" class="headerlink" title="GOF的23中模式中的下列11种模式是属于创建型模式。"></a>GOF的23中模式中的下列11种模式是属于创建型模式。</h2><ul>
<li>责任链模式：使多个对象都有机会处理请求，从而避免请求的发送者和接受者之间的耦合关系。将这些对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它为止。</li>
<li>命令模式：将一个请求封装为一个对象，从而可用不同的请求对客户进行参数化；对请求排队或记录请求日志，以及支持可撤销的操作。</li>
<li>解释器模式：给定一个语言，定义它文法的一种表示，并定义了一个解释器，这个解释器使用该表示来解释语言中的句子。</li>
<li>迭代器模式：提供一种方法顺序访问一个聚合对象中的各个元素，而又不需要暴露该对象的内部表示。</li>
<li>中介者模式：用一个中介对象来封装一系列的对象交互。中介者使各对象不需要显示地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。</li>
<li>备忘录模式：在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态，这样以后就可将该对象恢复到原先保存的状态。</li>
<li>观察者模式：定义对象间的一种一对多的依赖关系，当一个对象的状态发生变化时，所有依赖于它的对象都得到通知并被自动更新。</li>
<li>状态模式：允许一个对象在其内部状态改变时改变它的行为。对象看起来似乎修改了它的类。</li>
<li>策略模式：定义了一系列算法，把它们一个个封装起来，并且使它们可以相互替换。本模式使算法可独立于使用它的客户而变化。</li>
<li>模板方法模式：定义一个操作中算法的骨架，而将一些步骤延迟到子类中。模板方法使子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。</li>
<li>访问者模式：表示一个作用于某对象结构中的各个元素的操作。它可以在不改变各个元素的类的前提下定义作用于这些元素的新操作。</li>
</ul>
<h1 id="结构型模式"><a href="#结构型模式" class="headerlink" title="结构型模式"></a>结构型模式</h1><p>结构型模式涉及如何组合类和对象以形成更大的结构，和类有关的结构型模式涉及如何合理地使用继承机制；和对象有关的结构型模式涉及如何合理地使用对象组合机制。</p>
<h2 id="GOF的23种设计模式中的下列7种模式是属于创建型模式。"><a href="#GOF的23种设计模式中的下列7种模式是属于创建型模式。" class="headerlink" title="GOF的23种设计模式中的下列7种模式是属于创建型模式。"></a>GOF的23种设计模式中的下列7种模式是属于创建型模式。</h2><ul>
<li>适配器模式：将一个类的接口装换成客户希望的另一个接口。Adapter模式使原来由于接口不兼容而不能在一起工作的那些类可以一起工作。</li>
<li>组合模式：将对象组合成树形结构以表示“部分-整体”的层次结构。Composite使用户对单个对象和组合对象的使用具有一致性。</li>
<li>代理模式：为其他对象提供一种代理以控制对这个对象的访问。</li>
<li>享元模式：运用共享技术有效地支持大量细粒度的对象。</li>
<li>外观模式：为系统中的一组接口提供一个一致的界面，外观模式定义了一个高层接口，这个接口使这一子系统更加容易使用。</li>
<li>桥接模式：将抽象部分与它的实现部分分离，使它们都可以独立地变化。</li>
<li>装饰模式：动态地给对象添加一些额外的职责，就功能来说装饰模式相比生成子类更为灵活。</li>
</ul>
<p>简单的介绍下UML：</p>
<ul>
<li>类</li>
<li>接口</li>
<li>泛化关系 就是继承</li>
<li>关联关系<br><img src="http://p1.bqimg.com/4851/595ece72ffcd9acb.png" alt=""></li>
<li>依赖关系<br><img src="http://p1.bqimg.com/4851/22f9295218873108.png" alt=""></li>
<li>实现关系</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/总结/">总结</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--命令模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/25/Java设计模式--命令模式/" class="article-date">
      <time datetime="2016-09-25T01:30:06.000Z" itemprop="datePublished">2016-09-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/25/Java设计模式--命令模式/">Java设计模式--命令模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="命令模式-别名：动作，事物"><a href="#命令模式-别名：动作，事物" class="headerlink" title="命令模式(别名：动作，事物)"></a>命令模式(别名：动作，事物)</h1><p>为系统中的一组接口提供一个一致的界面，Facade模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。</p>
<h1 id="Command-Pattern（Another-name：Action，Transaction）"><a href="#Command-Pattern（Another-name：Action，Transaction）" class="headerlink" title="Command Pattern（Another name：Action，Transaction）"></a>Command Pattern（Another name：Action，Transaction）</h1><p>Encapsulate a request as an object, thereby letting you parameterize clients with different requests, queue or log requests, and support undoable operations.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://i1.piimg.com/4851/8f2457e2441c1e29.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>命令模式的结构中包四种角色。</p>
<ul>
<li>接受者（Receiver）：接受者是一个类的实例，该实例负责执行与请求相关的操作。</li>
<li>命令（Command）：命令是一个接口，规定了用来封装“请求”的若干个方法，比如：execute()、undo()等方法。</li>
<li>具体命令（Concrete command）：具体命令是实现命令接口的类的实例。具体命令必须实现接口中的方法，比如execute()，使该方法封装一个“请求”。</li>
<li>请求者（Invoker）：请求者是一个包含Command接口变量的类的实例。请求者中的Command接口的变量可以存放任何具体命令的引用。请求者负责调用具体命令，让具体命令执行那些封装“请求”的方法，比如execute()方法。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="接受者Receiver的类CompanyArmy-java"><a href="#接受者Receiver的类CompanyArmy-java" class="headerlink" title="接受者Receiver的类CompanyArmy.java"></a>接受者Receiver的类CompanyArmy.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Command;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CompanyArmy</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sneakAttack</span><span class="params">()</span> </span>&#123;</div><div class="line">		System.out.println(<span class="string">"我们知道了如何偷袭敌人，保证完成任务"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Command接口Command-java"><a href="#Command接口Command-java" class="headerlink" title="Command接口Command.java"></a>Command接口Command.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Command;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteCommand的实现类ConcreteCommand-java"><a href="#ConcreteCommand的实现类ConcreteCommand-java" class="headerlink" title="ConcreteCommand的实现类ConcreteCommand.java"></a>ConcreteCommand的实现类ConcreteCommand.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Command;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</div><div class="line"></div><div class="line">	CompanyArmy army;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ConcreteCommand</span><span class="params">(CompanyArmy army)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.army = army;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</div><div class="line">		army.sneakAttack();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="请求者类ArmySuperior-java"><a href="#请求者类ArmySuperior-java" class="headerlink" title="请求者类ArmySuperior.java"></a>请求者类ArmySuperior.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Command;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArmySuperior</span> </span>&#123;</div><div class="line">	Command command;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCommand</span><span class="params">(Command command)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.command = command;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startExecuteCommand</span><span class="params">()</span> </span>&#123;</div><div class="line">		command.execute();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Command;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		CompanyArmy 三连 = <span class="keyword">new</span> CompanyArmy();</div><div class="line">		Command command = <span class="keyword">new</span> ConcreteCommand(三连);</div><div class="line">		ArmySuperior 指挥官 = <span class="keyword">new</span> ArmySuperior();</div><div class="line">		指挥官.setCommand(command);</div><div class="line">		指挥官.startExecuteCommand();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="运行截图"><a href="#运行截图" class="headerlink" title="运行截图"></a>运行截图</h1><p><img src="http://i1.piimg.com/4851/f4a0c123da1e24fb.png" alt=""></p>
<h1 id="命令撤销的例子"><a href="#命令撤销的例子" class="headerlink" title="命令撤销的例子"></a>命令撤销的例子</h1><h2 id="接受者Receiver的类MakeDir-java"><a href="#接受者Receiver的类MakeDir-java" class="headerlink" title="接受者Receiver的类MakeDir.java"></a>接受者Receiver的类MakeDir.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> UndoCommand;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MakeDir</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createDir</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		File dir = <span class="keyword">new</span> File(name);</div><div class="line">		dir.mkdir();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteDir</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		File dir = <span class="keyword">new</span> File(name);</div><div class="line">		dir.delete();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Command接口Command-java-1"><a href="#Command接口Command-java-1" class="headerlink" title="Command接口Command.java"></a>Command接口Command.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> UndoCommand;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(String name)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteCommand的实现类ConcreteCommand-java-1"><a href="#ConcreteCommand的实现类ConcreteCommand-java-1" class="headerlink" title="ConcreteCommand的实现类ConcreteCommand.java"></a>ConcreteCommand的实现类ConcreteCommand.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> UndoCommand;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</div><div class="line">	ArrayList&lt;String&gt; dirNameList;</div><div class="line">	MakeDir makeDir;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ConcreteCommand</span><span class="params">(MakeDir makeDir)</span> </span>&#123;</div><div class="line">		dirNameList = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">		<span class="keyword">this</span>.makeDir = makeDir;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		makeDir.createDir(name);</div><div class="line">		dirNameList.add(name);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undo</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (dirNameList.size() &gt; <span class="number">0</span>) &#123;</div><div class="line">			<span class="keyword">int</span> m = dirNameList.size();</div><div class="line">			String str = dirNameList.get(m - <span class="number">1</span>);</div><div class="line">			makeDir.deleteDir(str);</div><div class="line">			dirNameList.remove(m - <span class="number">1</span>);</div><div class="line">		&#125; <span class="keyword">else</span></div><div class="line">			System.out.println(<span class="string">"没有需要撤销的操作"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="请求者类RequestMakedir-java"><a href="#请求者类RequestMakedir-java" class="headerlink" title="请求者类RequestMakedir.java"></a>请求者类RequestMakedir.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> UndoCommand;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestMakedir</span> </span>&#123;</div><div class="line">	Command command;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCommand</span><span class="params">(Command command)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.command = command;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startExecuteCommand</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		command.execute(name);</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">undoCommand</span><span class="params">()</span> </span>&#123;</div><div class="line">		command.undo();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java-1"><a href="#测试类Application-java-1" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> UndoCommand;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		MakeDir makeDir = <span class="keyword">new</span> MakeDir();</div><div class="line">		Command command = <span class="keyword">new</span> ConcreteCommand(makeDir);</div><div class="line">		RequestMakedir requestMakedir = <span class="keyword">new</span> RequestMakedir();</div><div class="line">		requestMakedir.setCommand(command);</div><div class="line">		requestMakedir.startExecuteCommand(<span class="string">"yxx"</span>);</div><div class="line">		requestMakedir.startExecuteCommand(<span class="string">"yn"</span>);</div><div class="line">		requestMakedir.undoCommand();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="运行截图-1"><a href="#运行截图-1" class="headerlink" title="运行截图"></a>运行截图</h1><p><img src="http://p1.bqimg.com/4851/3a1e59252469299d.png" alt=""></p>
<h1 id="命令模式的优点"><a href="#命令模式的优点" class="headerlink" title="命令模式的优点"></a>命令模式的优点</h1><ul>
<li>在命令模式中，请求者（Invoker）不直接与接受者（Receiver）交互，即请求者（Invoker）不包含接受者（Receiver）的引用，因此彻底消除了彼此之间的耦合。</li>
<li>命令模式满足“开-闭原则”。如果增加新的具体命令和该命令的接受者，不必修改调用者的代码，调用者就可以使用新的命令对象；反之，如果增加新的调用者，不必修改现有的具体命令和接受者，新增加的调用者就可以使用已有的具体命令。</li>
<li>由于请求者的请求被封装到了具体命令中，那么就可以将具体命令保存到持久化的媒介中，在需要的时候，重新执行这个具体命令。因此，使用命令模式可以记录日志。</li>
<li>使用命令模式可以对请求者的“请求”进行排队。每个请求都各自对应一个具体命令，因此可以按一定顺序执行这些命令。</li>
</ul>
<h1 id="适用命令模式的情景"><a href="#适用命令模式的情景" class="headerlink" title="适用命令模式的情景"></a>适用命令模式的情景</h1><ul>
<li>程序需要在不同的时刻制定、排列和执行请求。</li>
<li>程序需要提供撤销操作。</li>
<li>程序需要支持宏操作。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/命令模式/">命令模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--外观模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/25/Java设计模式--外观模式/" class="article-date">
      <time datetime="2016-09-25T01:02:06.000Z" itemprop="datePublished">2016-09-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/25/Java设计模式--外观模式/">Java设计模式--外观模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="外观模式"><a href="#外观模式" class="headerlink" title="外观模式"></a>外观模式</h1><p>为系统中的一组接口提供一个一致的界面，Facade模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。</p>
<h1 id="Facade-Pattern"><a href="#Facade-Pattern" class="headerlink" title="Facade Pattern"></a>Facade Pattern</h1><p>Provide a unified interface to a set of interfaces in a subsystem. Facade defines a higher-level interface that makes the subsystem easier to use.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://p1.bqimg.com/4851/29d1d36bc189cdad.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>外观模式的结构中包两种角色。</p>
<ul>
<li>子系统（Subsystem）：子系统是若干个类的集合，这些类的实例协同合作为用户提供所需要的功能，子系统中任何类都不包含外观类的实例引用。</li>
<li>外观（Facade）：外观是一个类，该类包含子系统中全部或部分类的实例引用，当用户想要和子系统中的若干个类的实例打交道时，可以代替地和子系统的外观类的实例打交道。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="子系统CheckWord-java"><a href="#子系统CheckWord-java" class="headerlink" title="子系统CheckWord.java"></a>子系统CheckWord.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Facade;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckWord</span> </span>&#123;</div><div class="line">	<span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> basicAmount = <span class="number">85</span>;</div><div class="line">	String advertisement;</div><div class="line">	<span class="keyword">int</span> amount;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CheckWord</span><span class="params">(String advertisement)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.advertisement = advertisement;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAmount</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.amount = <span class="keyword">this</span>.advertisement.length() + basicAmount;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAmount</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.amount;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="子系统Charge-java"><a href="#子系统Charge-java" class="headerlink" title="子系统Charge.java"></a>子系统Charge.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Facade;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Charge</span> </span>&#123;</div><div class="line">	<span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> basicCharge = <span class="number">12</span>;</div><div class="line">	CheckWord checkWord;</div><div class="line">	Charge(CheckWord checkWord) &#123;</div><div class="line">		<span class="keyword">this</span>.checkWord = checkWord;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">giveCharge</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">int</span> charge = checkWord.getAmount() * basicCharge;</div><div class="line">		System.out.println(<span class="string">"广告费用:"</span> + charge + <span class="string">"元"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="子系统TypeSeting-java"><a href="#子系统TypeSeting-java" class="headerlink" title="子系统TypeSeting.java"></a>子系统TypeSeting.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">ppackage Facade;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeSeting</span> </span>&#123;</div><div class="line">	String advertisement;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TypeSeting</span><span class="params">(String advertisement)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.advertisement = advertisement;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">typeSeting</span><span class="params">()</span> </span>&#123;</div><div class="line">		System.out.println(<span class="string">"广告排版格式:"</span>);</div><div class="line">		System.out.println(<span class="string">"*****************"</span>);</div><div class="line">		System.out.println(<span class="keyword">this</span>.advertisement);</div><div class="line">		System.out.println(<span class="string">"*****************"</span>);</div><div class="line">	&#125;	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="外观ClientServerFacade-java"><a href="#外观ClientServerFacade-java" class="headerlink" title="外观ClientServerFacade.java"></a>外观ClientServerFacade.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Facade;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientServerFacade</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> CheckWord checkWord;</div><div class="line">	<span class="keyword">private</span> Charge charge;</div><div class="line">	<span class="keyword">private</span> TypeSeting typeSeting;</div><div class="line">	String advertisement;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ClientServerFacade</span><span class="params">(String advertisement)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.advertisement = advertisement;</div><div class="line">		checkWord = <span class="keyword">new</span> CheckWord(advertisement);</div><div class="line">		charge = <span class="keyword">new</span> Charge(checkWord);</div><div class="line">		typeSeting = <span class="keyword">new</span> TypeSeting(advertisement);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAdvertisement</span><span class="params">()</span> </span>&#123;</div><div class="line">		checkWord.setAmount();</div><div class="line">		charge.giveCharge();</div><div class="line">		typeSeting.typeSeting();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Facade;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		String clientAdvertisement = <span class="string">"电脑,价格63377,联系电话5059676"</span>;</div><div class="line">		ClientServerFacade csf = <span class="keyword">new</span> ClientServerFacade(clientAdvertisement);</div><div class="line">		csf.doAdvertisement();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="运行截图"><a href="#运行截图" class="headerlink" title="运行截图"></a>运行截图</h1><p><img src="http://p1.bqimg.com/4851/90988a53f26c5248.png" alt=""></p>
<h1 id="外观模式的优点"><a href="#外观模式的优点" class="headerlink" title="外观模式的优点"></a>外观模式的优点</h1><ul>
<li>使客户和子系统中的类无耦合，并且使子系统使用起来更加方便。</li>
<li>外观只是提供了一个更加简洁的界面，并不影响用户直接使用子系统中的类。</li>
<li>子系统中任何类对方法的内容进行修改，不影响外观类的代码。</li>
</ul>
<h1 id="适用外观模式的情景"><a href="#适用外观模式的情景" class="headerlink" title="适用外观模式的情景"></a>适用外观模式的情景</h1><ul>
<li>对于一个复杂的子系统，需要为用户提供一个简单的交互操作。</li>
<li>不希望客户代码和子系统中的类有耦合，以便提高子系统的独立性和可移植性。</li>
<li>当整个系统需要构建一个层次结构的子系统，不希望这些子系统相互直接的交互。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/外观模式/">外观模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--中介者模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/25/Java设计模式--中介者模式/" class="article-date">
      <time datetime="2016-09-25T00:25:06.000Z" itemprop="datePublished">2016-09-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/25/Java设计模式--中介者模式/">Java设计模式--中介者模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="中介者模式"><a href="#中介者模式" class="headerlink" title="中介者模式"></a>中介者模式</h1><p>用一个中介对象来封装一系列的对象交互。中介者使各对象不需要显示地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。</p>
<h1 id="Mediator-Pattern"><a href="#Mediator-Pattern" class="headerlink" title="Mediator Pattern"></a>Mediator Pattern</h1><p>Define an object that encapsulates how a set of objects interact. Mediator promotes loose coupling by keeping objects from refering to each other explicitly, and it lets you vary their interaction independently.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://p1.bpimg.com/4851/cad3177d9b4d947c.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>中介者模式的结构中包括四种角色。</p>
<ul>
<li>中介者（Mediator）：中介者使一个接口，该接口定义了用于同事（Colleague）对象之间进行通信的方法。</li>
<li>具体中介者（Concrete Mediator）：具体中介者是实现中介者接口的类。具体中介者需要包含所有具体同事（Concrete Colleague）的引用，并通过实现中介者接口中的方法来满足具体同事之间的通信请求。</li>
<li>同事（Colleague）：一个接口，规定了具体同事需要实现的方法。</li>
<li>具体同事（Concrete Colleague）：实现同事接口的类。具体同事需要包含具体中介者的引用，一个具体同事需要和其他同事交互时，只需将自己的请求通知给它所包含的具体中介者即可。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="同事接口类Colleague-java"><a href="#同事接口类Colleague-java" class="headerlink" title="同事接口类Colleague.java"></a>同事接口类Colleague.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Mediator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Colleague</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">giveMess</span><span class="params">(String[] mess)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiverMess</span><span class="params">(String mess)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="本问题直接需要一个具体中介者ConcreteMediator-java"><a href="#本问题直接需要一个具体中介者ConcreteMediator-java" class="headerlink" title="本问题直接需要一个具体中介者ConcreteMediator.java"></a>本问题直接需要一个具体中介者ConcreteMediator.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Mediator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteMediator</span> </span>&#123;</div><div class="line">	ColleagueA colleagueA;</div><div class="line">	ColleagueB colleagueB;</div><div class="line">	ColleagueC colleagueC;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerColleagueA</span><span class="params">(ColleagueA colleagueA)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.colleagueA = colleagueA;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerColleagueB</span><span class="params">(ColleagueB colleagueB)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.colleagueB = colleagueB;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerColleagueC</span><span class="params">(ColleagueC colleagueC)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.colleagueC = colleagueC;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deliverMess</span><span class="params">(Colleague colleague, String[] mess)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (colleague == colleagueA) &#123;</div><div class="line">			<span class="keyword">if</span> (mess.length &gt;= <span class="number">2</span>) &#123;</div><div class="line">				colleagueB.receiverMess(colleague.getName() + mess[<span class="number">0</span>]);</div><div class="line">				colleagueC.receiverMess(colleague.getName() + mess[<span class="number">1</span>]);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (colleague == colleagueB) &#123;</div><div class="line">			<span class="keyword">if</span> (mess.length &gt;= <span class="number">2</span>) &#123;</div><div class="line">				colleagueA.receiverMess(colleague.getName() + mess[<span class="number">0</span>]);</div><div class="line">				colleagueC.receiverMess(colleague.getName() + mess[<span class="number">1</span>]);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (colleague == colleagueC) &#123;</div><div class="line">			<span class="keyword">if</span> (mess.length &gt;= <span class="number">2</span>) &#123;</div><div class="line">				colleagueA.receiverMess(colleague.getName() + mess[<span class="number">0</span>]);</div><div class="line">				colleagueB.receiverMess(colleague.getName() + mess[<span class="number">1</span>]);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteColleague的实现类ColleagueA-java"><a href="#ConcreteColleague的实现类ColleagueA-java" class="headerlink" title="ConcreteColleague的实现类ColleagueA.java"></a>ConcreteColleague的实现类ColleagueA.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Mediator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ColleagueA</span> <span class="keyword">implements</span> <span class="title">Colleague</span> </span>&#123;</div><div class="line"></div><div class="line">	ConcreteMediator cm;</div><div class="line">	String name;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ColleagueA</span><span class="params">(ConcreteMediator cm)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.cm = cm;</div><div class="line">		cm.registerColleagueA(<span class="keyword">this</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">giveMess</span><span class="params">(String[] mess)</span> </span>&#123;</div><div class="line">		cm.deliverMess(<span class="keyword">this</span>, mess);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiverMess</span><span class="params">(String mess)</span> </span>&#123;</div><div class="line">		System.out.println(name + <span class="string">"收到的信息"</span>);</div><div class="line">		System.out.println(<span class="string">"\t"</span> + mess);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteColleague的实现类ColleagueB-java"><a href="#ConcreteColleague的实现类ColleagueB-java" class="headerlink" title="ConcreteColleague的实现类ColleagueB.java"></a>ConcreteColleague的实现类ColleagueB.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Mediator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ColleagueB</span> <span class="keyword">implements</span> <span class="title">Colleague</span> </span>&#123;</div><div class="line"></div><div class="line">	ConcreteMediator cm;</div><div class="line">	String name;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ColleagueB</span><span class="params">(ConcreteMediator cm)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.cm = cm;</div><div class="line">		cm.registerColleagueB(<span class="keyword">this</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">giveMess</span><span class="params">(String[] mess)</span> </span>&#123;</div><div class="line">		cm.deliverMess(<span class="keyword">this</span>, mess);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiverMess</span><span class="params">(String mess)</span> </span>&#123;</div><div class="line">		System.out.println(name + <span class="string">"收到的信息"</span>);</div><div class="line">		System.out.println(<span class="string">"\t"</span> + mess);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteColleague的实现类ColleagueC-java"><a href="#ConcreteColleague的实现类ColleagueC-java" class="headerlink" title="ConcreteColleague的实现类ColleagueC.java"></a>ConcreteColleague的实现类ColleagueC.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Mediator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ColleagueC</span> <span class="keyword">implements</span> <span class="title">Colleague</span> </span>&#123;</div><div class="line"></div><div class="line">	ConcreteMediator cm;</div><div class="line">	String name;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ColleagueC</span><span class="params">(ConcreteMediator cm)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.cm = cm;</div><div class="line">		cm.registerColleagueC(<span class="keyword">this</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">giveMess</span><span class="params">(String[] mess)</span> </span>&#123;</div><div class="line">		cm.deliverMess(<span class="keyword">this</span>, mess);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiverMess</span><span class="params">(String mess)</span> </span>&#123;</div><div class="line">		System.out.println(name + <span class="string">"收到的信息"</span>);</div><div class="line">		System.out.println(<span class="string">"\t"</span> + mess);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Mediator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Appication</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		ConcreteMediator cm = <span class="keyword">new</span> ConcreteMediator();</div><div class="line">		ColleagueA colleagueA = <span class="keyword">new</span> ColleagueA(cm);</div><div class="line">		ColleagueB colleagueB = <span class="keyword">new</span> ColleagueB(cm);</div><div class="line">		ColleagueC colleagueC = <span class="keyword">new</span> ColleagueC(cm);</div><div class="line">		colleagueA.setName(<span class="string">"A国"</span>);</div><div class="line">		colleagueB.setName(<span class="string">"B国"</span>);</div><div class="line">		colleagueC.setName(<span class="string">"C国"</span>);</div><div class="line">		String[] messA = &#123;<span class="string">"要求归还曾抢夺的100斤土豆"</span>, <span class="string">"要求归还曾抢夺的20头牛"</span>&#125;;</div><div class="line">		colleagueA.giveMess(messA);</div><div class="line">		</div><div class="line">		String[] messB = &#123;<span class="string">"要求归还曾抢夺的10只公鸡"</span>, <span class="string">"要求归还曾抢夺的15匹马"</span>&#125;;</div><div class="line">		colleagueB.giveMess(messB);</div><div class="line">		</div><div class="line">		String[] messC = &#123;<span class="string">"要求归还曾抢夺的300斤小麦"</span>, <span class="string">"要求归还曾抢夺的50头驴"</span>&#125;;</div><div class="line">		colleagueC.giveMess(messC);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="运行截图"><a href="#运行截图" class="headerlink" title="运行截图"></a>运行截图</h1><p><img src="http://p1.bqimg.com/4851/ced5ca588f1815fb.png" alt=""></p>
<h1 id="中介者模式的优点"><a href="#中介者模式的优点" class="headerlink" title="中介者模式的优点"></a>中介者模式的优点</h1><ul>
<li>可以避免许多的对象为了之间的通信而相互显示引用，否则，不仅系统难于维护，而且也使其他系统难以复用这些对象。</li>
<li>可以通过中介者将原本分布于多个对象之间的交互行为集中在一起。当这些对象之间需要改变之间的通信行为时，只需使用一个具体中介者即可，不必修改各个具体同事的代码，即这些同事可被重用。</li>
<li>具体中介者使得各个具体同事完全解耦，修改任何一个具体同事的代码不会影响到其他同事。</li>
<li>具体中介者集中了同事之间是如何交互的细节，使系统比较清楚地知道整个系统中同事是如何交互的。</li>
<li>当一些对象想相互通信，但又无法相互包含对方的引用，那么使用中介者模式就可以使这些对象互相通信。<br>注：由于具体中介者集中了同事之间是如何交互的细节，可能使具体具体中介者变得非常复杂，增加了维护的难度。</li>
</ul>
<h1 id="适用中介者模式的情景"><a href="#适用中介者模式的情景" class="headerlink" title="适用中介者模式的情景"></a>适用中介者模式的情景</h1><ul>
<li>许多对象以复杂的方式交，所导致的依赖关系使系统难以理解和维护。</li>
<li>一个对象引用其他很多对象，导致难以复用该对象。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/中介者模式/">中介者模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--生成器模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/24/Java设计模式--生成器模式/" class="article-date">
      <time datetime="2016-09-24T06:13:06.000Z" itemprop="datePublished">2016-09-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/24/Java设计模式--生成器模式/">Java设计模式--生成器模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="生成器模式"><a href="#生成器模式" class="headerlink" title="生成器模式"></a>生成器模式</h1><p>将一个复杂对象的构建与它的表示分离，使同样的构建过程可以创建不同的表示。</p>
<h1 id="Builder-Pattern"><a href="#Builder-Pattern" class="headerlink" title="Builder Pattern"></a>Builder Pattern</h1><p>Separate the construction of a complex object from its representation so that the same construction process can create different representations.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://p1.bpimg.com/4851/c71b69f961e1f8eb.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>生成器模式的结构中包括四个角色。</p>
<ul>
<li>产品（Product）：具体生成器要构造的复杂对象。</li>
<li>抽象生成器（Abstract Builder）：抽象生成器是一个接口，该接口除了为创建一个Product对象的各个组件定义了若干个方法外，还定义返回Product对象的方法。</li>
<li>具体生成器（Concrete Builder）：实现Builder接口的类，具体生成器将实现Builder接口所定义的方法。</li>
<li>指挥者（Director）：指挥者是一个类，该类需含有Builder接口声明的变量。指挥者的职责是负责向用户提供具体生成器，即指挥者将请求具体生成器来构造用户所需要的Product对象，如果所请求的具体生成器成功地构造出Product对象，指挥者就可以让该具体生成器返回所构造的Product对象。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Product的抽象类PanelProduct-java"><a href="#Product的抽象类PanelProduct-java" class="headerlink" title="Product的抽象类PanelProduct.java"></a>Product的抽象类PanelProduct.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Builder;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PanelProduct</span> <span class="keyword">extends</span> <span class="title">JPanel</span> </span>&#123;</div><div class="line">	JButton button;</div><div class="line">	JLabel label;</div><div class="line">	JTextField textField;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="抽象生成器Builder接口类Builder-java"><a href="#抽象生成器Builder接口类Builder-java" class="headerlink" title="抽象生成器Builder接口类Builder.java"></a>抽象生成器Builder接口类Builder.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Builder;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JPanel;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Builder</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildButton</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildLabel</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildTextField</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> JPanel <span class="title">getPanel</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteBuilder的实现类ConcreteBuilderOne-java"><a href="#ConcreteBuilder的实现类ConcreteBuilderOne-java" class="headerlink" title="ConcreteBuilder的实现类ConcreteBuilderOne.java"></a>ConcreteBuilder的实现类ConcreteBuilderOne.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Builder;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JButton;</div><div class="line"><span class="keyword">import</span> javax.swing.JLabel;</div><div class="line"><span class="keyword">import</span> javax.swing.JPanel;</div><div class="line"><span class="keyword">import</span> javax.swing.JTextField;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteBuilderOne</span> <span class="keyword">implements</span> <span class="title">Builder</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> PanelProduct panel;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ConcreteBuilderOne</span><span class="params">()</span> </span>&#123;</div><div class="line">		panel = <span class="keyword">new</span> PanelProduct();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildButton</span><span class="params">()</span> </span>&#123;</div><div class="line">		panel.button = <span class="keyword">new</span> JButton(<span class="string">"按钮"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildLabel</span><span class="params">()</span> </span>&#123;</div><div class="line">		panel.label = <span class="keyword">new</span> JLabel(<span class="string">"标签"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildTextField</span><span class="params">()</span> </span>&#123;</div><div class="line">		panel.textField = <span class="keyword">new</span> JTextField(<span class="string">"文本框"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> JPanel <span class="title">getPanel</span><span class="params">()</span> </span>&#123;</div><div class="line">		panel.add(panel.button);</div><div class="line">		panel.add(panel.label);</div><div class="line">		panel.add(panel.textField);</div><div class="line">		<span class="keyword">return</span> panel;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ConcreteBuilder的实现类ConcreteBuilderTwo-java"><a href="#ConcreteBuilder的实现类ConcreteBuilderTwo-java" class="headerlink" title="ConcreteBuilder的实现类ConcreteBuilderTwo.java"></a>ConcreteBuilder的实现类ConcreteBuilderTwo.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Builder;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JButton;</div><div class="line"><span class="keyword">import</span> javax.swing.JLabel;</div><div class="line"><span class="keyword">import</span> javax.swing.JPanel;</div><div class="line"><span class="keyword">import</span> javax.swing.JTextField;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteBuilderTwo</span> <span class="keyword">implements</span> <span class="title">Builder</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> PanelProduct panel;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ConcreteBuilderTwo</span><span class="params">()</span> </span>&#123;</div><div class="line">		panel = <span class="keyword">new</span> PanelProduct();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildButton</span><span class="params">()</span> </span>&#123;</div><div class="line">		panel.button = <span class="keyword">new</span> JButton(<span class="string">"button"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildLabel</span><span class="params">()</span> </span>&#123;</div><div class="line">		panel.label = <span class="keyword">new</span> JLabel(<span class="string">"label"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildTextField</span><span class="params">()</span> </span>&#123;</div><div class="line">		panel.textField = <span class="keyword">new</span> JTextField(<span class="string">"My文本框"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> JPanel <span class="title">getPanel</span><span class="params">()</span> </span>&#123;</div><div class="line">		panel.add(panel.textField);</div><div class="line">		panel.add(panel.label);</div><div class="line">		panel.add(panel.button);</div><div class="line">		<span class="keyword">return</span> panel;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="指挥类Director-java"><a href="#指挥类Director-java" class="headerlink" title="指挥类Director.java"></a>指挥类Director.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Builder;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JPanel;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Director</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> Builder builder;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Director</span><span class="params">(Builder builder)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.builder = builder;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> JPanel <span class="title">constructProduct</span><span class="params">()</span> </span>&#123;</div><div class="line">		builder.buildButton();</div><div class="line">		builder.buildLabel();</div><div class="line">		builder.buildTextField();</div><div class="line">		JPanel product = builder.getPanel();</div><div class="line">		<span class="keyword">return</span> product;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">ppackage Builder;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JFrame;</div><div class="line"><span class="keyword">import</span> javax.swing.JPanel;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Builder builder = <span class="keyword">new</span> ConcreteBuilderOne();</div><div class="line">		Director director = <span class="keyword">new</span> Director(builder);</div><div class="line">		JPanel panel = director.constructProduct();</div><div class="line">		JFrame frameOne = <span class="keyword">new</span> JFrame();</div><div class="line">		frameOne.add(panel);</div><div class="line">		frameOne.setBounds(<span class="number">12</span>, <span class="number">12</span>, <span class="number">200</span>, <span class="number">120</span>);</div><div class="line">		frameOne.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</div><div class="line">		frameOne.setVisible(<span class="keyword">true</span>);</div><div class="line">		</div><div class="line">		builder = <span class="keyword">new</span> ConcreteBuilderTwo();</div><div class="line">		director = <span class="keyword">new</span> Director(builder);</div><div class="line">		panel = director.constructProduct();</div><div class="line">		JFrame frameTwo = <span class="keyword">new</span> JFrame();</div><div class="line">		frameTwo.add(panel);</div><div class="line">		frameTwo.setBounds(<span class="number">212</span>, <span class="number">12</span>, <span class="number">200</span>, <span class="number">120</span>);</div><div class="line">		frameTwo.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</div><div class="line">		frameTwo.setVisible(<span class="keyword">true</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="运行截图"><a href="#运行截图" class="headerlink" title="运行截图"></a>运行截图</h1><p><img src="http://p1.bpimg.com/4851/414e0c8f7c3a68eb.png" alt=""></p>
<h1 id="生成器模式的优点"><a href="#生成器模式的优点" class="headerlink" title="生成器模式的优点"></a>生成器模式的优点</h1><ul>
<li>生成器模式将对象的构造过程封装在具体生成器中，用户使用不同的具体生成器就可以得到该对象的不同表示。</li>
<li>生成器模式将对象的构造过程从创建对象的类中分离出来，使用户无需了解该对象的具体组件。</li>
<li>可以更加精细有效地控制对象的构造过程。生成器将对象的构造过程分解成若干步骤，这就使程序可以更加精细，有效地控制整个对象的构造。</li>
<li>生成器模式将对象的构造过程与创建该对象类解耦，使对象的创建更加灵活有弹性。</li>
<li>当增加新的具体生成器时，不必修改指挥者的代码，即该模式满足开-闭原则。</li>
</ul>
<h1 id="适用生成器模式的情景"><a href="#适用生成器模式的情景" class="headerlink" title="适用生成器模式的情景"></a>适用生成器模式的情景</h1><ul>
<li>当系统准备为用户提供一个内部结构复杂的对象，而且在构造方法中编写创建该对象的代码无法满足用户需求时，就可以使用生成器模式来构造这样的对象。</li>
<li>当某些系统要求对象的构造过程必须独立于创建该对象的类时。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/生成器模式/">生成器模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--策略模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/23/Java设计模式--策略模式/" class="article-date">
      <time datetime="2016-09-22T16:26:06.000Z" itemprop="datePublished">2016-09-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/23/Java设计模式--策略模式/">Java设计模式--策略模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="策略模式（别名：政策）"><a href="#策略模式（别名：政策）" class="headerlink" title="策略模式（别名：政策）"></a>策略模式（别名：政策）</h1><p>定义一系列算法，把它们一个个封装起来，并且使它们可相互替换。本模式使得算法可独立于使用它的客户而变化。</p>
<h1 id="Strategy-Pattern（Another-Name-Policy）"><a href="#Strategy-Pattern（Another-Name-Policy）" class="headerlink" title="Strategy Pattern（Another Name: Policy）"></a>Strategy Pattern（Another Name: Policy）</h1><p>Define a family of algorithms, encapsulate each one, and make them inter changeable. Strategy lets the algorithm vary independently from clients that use it.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://ww2.sinaimg.cn/large/0060lm7Tgw1f83880k4ajj30qj0b3abr.jpg" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>策略方法模式的结构中包括三种角色。</p>
<ul>
<li>策略（Strategy）：策略是一个接口，该接口定义若干个算法标识，即定义了若干个抽象方法。</li>
<li>具体策略（Concrete Strategy）：具体策略是实现策略接口的类。具体策略实现策略接口所定义的抽象方法，即给出算法标识的具体算法。</li>
<li>上下文（Context）：上下文是依赖于策略接口的类，即上下文包含有策略声明的变量。上下文中提供一个方法，该方法委托策略变量调用具体策略所实现的策略接口中的方法。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Abstract-Strategy的接口类ComputableStrategy-java"><a href="#Abstract-Strategy的接口类ComputableStrategy-java" class="headerlink" title="Abstract Strategy的接口类ComputableStrategy.java"></a>Abstract Strategy的接口类ComputableStrategy.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Strategy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ComputableStrategy</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">double</span> <span class="title">computableStrategy</span><span class="params">(<span class="keyword">double</span>[] a)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Strategy的实现类StrategyOne-java"><a href="#Strategy的实现类StrategyOne-java" class="headerlink" title="Strategy的实现类StrategyOne.java"></a>Strategy的实现类StrategyOne.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Strategy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyOne</span> <span class="keyword">implements</span> <span class="title">ComputableStrategy</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">computableStrategy</span><span class="params">(<span class="keyword">double</span>[] a)</span> </span>&#123;</div><div class="line">		<span class="keyword">double</span> score = <span class="number">0</span>, sum = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length; i++) &#123;</div><div class="line">			sum = sum + a[i];</div><div class="line">		&#125;</div><div class="line">		score = sum/a.length;</div><div class="line">		<span class="keyword">return</span> score;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Strategy的实现类StrategyTwo-java"><a href="#Strategy的实现类StrategyTwo-java" class="headerlink" title="Strategy的实现类StrategyTwo.java"></a>Strategy的实现类StrategyTwo.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Strategy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyTwo</span> <span class="keyword">implements</span> <span class="title">ComputableStrategy</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">computableStrategy</span><span class="params">(<span class="keyword">double</span>[] a)</span> </span>&#123;</div><div class="line">		<span class="keyword">double</span> score = <span class="number">0</span>, multi = <span class="number">1</span>;</div><div class="line">		<span class="keyword">int</span> n = a.length;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length; i++) &#123;</div><div class="line">			multi = multi * a[i];</div><div class="line">		&#125;</div><div class="line">		score = Math.pow(multi, <span class="number">1.0</span>/n);</div><div class="line">		<span class="keyword">return</span> score;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Strategy的实现类StrategyThree-java"><a href="#Strategy的实现类StrategyThree-java" class="headerlink" title="Strategy的实现类StrategyThree.java"></a>Strategy的实现类StrategyThree.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Strategy;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Arrays;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyThree</span> <span class="keyword">implements</span> <span class="title">ComputableStrategy</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">computableStrategy</span><span class="params">(<span class="keyword">double</span>[] a)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (a.length &lt;= <span class="number">2</span>)</div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		<span class="keyword">double</span> score = <span class="number">0</span>, sum = <span class="number">0</span>;</div><div class="line">		Arrays.sort(a);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; a.length - <span class="number">1</span>; i++) &#123;</div><div class="line">			sum = sum + a[i];</div><div class="line">		&#125;</div><div class="line">		score = sum/(a.length-<span class="number">2</span>);</div><div class="line">		<span class="keyword">return</span> score;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Context类GymnasticsGame-java"><a href="#Context类GymnasticsGame-java" class="headerlink" title="Context类GymnasticsGame.java"></a>Context类GymnasticsGame.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Strategy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GymnasticsGame</span> </span>&#123;</div><div class="line">	ComputableStrategy strategy;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStrategy</span><span class="params">(ComputableStrategy strategy)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.strategy = strategy;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getPersonScore</span><span class="params">(<span class="keyword">double</span> a[])</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (strategy != <span class="keyword">null</span>) &#123;</div><div class="line">			<span class="keyword">return</span> strategy.computableStrategy(a);</div><div class="line">		&#125; <span class="keyword">else</span></div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Strategy;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		GymnasticsGame game = <span class="keyword">new</span> GymnasticsGame();</div><div class="line">		game.setStrategy(<span class="keyword">new</span> StrategyOne());</div><div class="line">		Person zhang = <span class="keyword">new</span> Person();</div><div class="line">		zhang.setName(<span class="string">"张三"</span>);</div><div class="line">		<span class="keyword">double</span>[] a = &#123;<span class="number">9.12</span>, <span class="number">9.25</span>, <span class="number">8.87</span>, <span class="number">9.99</span>, <span class="number">6.99</span>, <span class="number">7.88</span>&#125;;</div><div class="line">		Person li = <span class="keyword">new</span> Person();</div><div class="line">		li.setName(<span class="string">"李四"</span>);</div><div class="line">		zhang.setScore(game.getPersonScore(a));</div><div class="line">		li.setScore(game.getPersonScore(a));</div><div class="line">		System.out.println(zhang.getScore());</div><div class="line">		System.out.println(li.getScore());</div><div class="line">		</div><div class="line">		game.setStrategy(<span class="keyword">new</span> StrategyThree());</div><div class="line">		zhang.setScore(game.getPersonScore(a));</div><div class="line">		li.setScore(game.getPersonScore(a));</div><div class="line">		System.out.println(zhang.getScore());</div><div class="line">		System.out.println(li.getScore());</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">	String name;</div><div class="line">	<span class="keyword">double</span> score;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getScore</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> score;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setScore</span><span class="params">(<span class="keyword">double</span> score)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.score = score;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="执行效果图"><a href="#执行效果图" class="headerlink" title="执行效果图"></a>执行效果图</h1><p><img src="http://ww1.sinaimg.cn/large/0060lm7Tgw1f838pj0iekj30eg048t9w.jpg" alt=""></p>
<h1 id="策略模式的优点"><a href="#策略模式的优点" class="headerlink" title="策略模式的优点"></a>策略模式的优点</h1><ul>
<li>上下文（Context）和具体策略（ConcreteStrategy）是松耦合关系。因此上下文只知道它要使用某一个实现Strategy接口类的实例，但不需要知道具体是哪一个类。</li>
<li>策略模式满足“开-闭原则”。当增加新的具体策略时，不需要修改上下文类的代码，上下文就可以引用新的具体策略的实例。</li>
</ul>
<h1 id="适用策略模式的情景"><a href="#适用策略模式的情景" class="headerlink" title="适用策略模式的情景"></a>适用策略模式的情景</h1><ul>
<li>一个类定义了多种行为，并且这些行为在这个类的方法中以多个条件语句的形式出现，那么可以使用策略模式避免在类中使用大量的条件语句。</li>
<li>程序不希望暴露复杂的、与算法有关的数据结构，那么可以使用策略模式封装算法。</li>
<li>需要使用一个算法的不同变体。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/策略模式/">策略模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--原型模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/19/Java设计模式--原型模式/" class="article-date">
      <time datetime="2016-09-19T10:43:06.000Z" itemprop="datePublished">2016-09-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/19/Java设计模式--原型模式/">Java设计模式--原型模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a>原型模式</h1><p>用原型实例制定创建对象的种类，并且通过复制这些原型创建新的对象。</p>
<h1 id="Prototype-Pattern"><a href="#Prototype-Pattern" class="headerlink" title="Prototype Pattern"></a>Prototype Pattern</h1><p>Specify the kinds of objects to create using a prototypical instance, and create new objects by copying this prototype.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://ww4.sinaimg.cn/large/0060lm7Tgw1f7z3az58c6j30h20ah757.jpg" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>原型方法模式的结构中包括两种角色。</p>
<ul>
<li>抽象原型（Abstract Prototype）：是一个接口，负责定义对象复制自身的方法。</li>
<li>具体原型（Concrete Prototype）：实现Prototype接口的类。具体原型实现抽象原型中的方法，以便所创建的对象调用该方法复制自己。</li>
</ul>
<h1 id="克隆方法"><a href="#克隆方法" class="headerlink" title="克隆方法"></a>克隆方法</h1><h2 id="理解深克隆和浅克隆"><a href="#理解深克隆和浅克隆" class="headerlink" title="理解深克隆和浅克隆"></a>理解深克隆和浅克隆</h2><ul>
<li>1：被复制对象的所有变量都含有与原来的对象相同的值，而所有的对其他对象的引用仍然指向原来的对象。换言之，浅复制仅仅复制所考虑的对象，而不复制它所引用的对象。</li>
<li>2：被复制对象的所有变量都含有与原来的对象相同的值，除去那些引用其他对象的变量。那些引用其他对象的变量将指向被复制过的新对象，而不再是原有的那些被引用的对象。换言之，深复制把要复制的对象所引用的对象都复制了一遍。</li>
</ul>
<h2 id="clone-方法"><a href="#clone-方法" class="headerlink" title="clone()方法"></a>clone()方法</h2><p>java.lang包中的Object类提供了一个权限是protected的用于复制对象的clone()的方法。我们知道Java中所有的类都是java.lang包中Object类的子类或者间接子类，因此Java中所有的类都继承这个clone()方法，但是由于clone()方法的访问权限是protected的，这就意味着，如果一个对象想使用该方法得到自己的一个复制品，就必须保证自己所在的类与Object类在同一个包中，这显然是不可能的，因为Java不允许用户编写的类拥有java.lang这样的包名（尽管可以编译拥有java.lang包名的类，但允许时JVM拒绝加载这样的类）。</p>
<h2 id="clone-方法的重写与Cloneable接口"><a href="#clone-方法的重写与Cloneable接口" class="headerlink" title="clone()方法的重写与Cloneable接口"></a>clone()方法的重写与Cloneable接口</h2><p>为了能让一个对象使用clone()方法，创建该对象的类可以重写(覆盖)clone()方法，并将访问权限提高为public权限，为了能使用被覆盖的clone()方法，只需在重写的clone()方法中使用关键字super调用Object类的clone()方法即可。也可以在创建对象的类中新定义一个复制对象的方法，将访问权限定义为public，并在该方法中调用Object类的clone()方法。<br>另外，当对象调用Object类中的clone()方法时，JVM将会逐个复制该对象的成员变量，然后创建一个新对象返回，所以JVM要求调用clone()方法的对象必须实现Cloneable接口。Cloneable接口中没有任何方法，该接口的唯一作用就是让JVM知道实现该接口的对象是可以被克隆的。</p>
<h1 id="下面Circle类的对象使用clone方法克隆自己的CloneExample-java"><a href="#下面Circle类的对象使用clone方法克隆自己的CloneExample-java" class="headerlink" title="下面Circle类的对象使用clone方法克隆自己的CloneExample.java"></a>下面Circle类的对象使用clone方法克隆自己的CloneExample.java</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Prototype;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">double</span> radius;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getRadius</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> radius;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRadius</span><span class="params">(<span class="keyword">double</span> radius)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.radius = radius;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</div><div class="line">		Object object = <span class="keyword">super</span>.clone();</div><div class="line">		<span class="keyword">return</span> object;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CloneExample</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Circle circle = <span class="keyword">new</span> Circle();</div><div class="line">		circle.setRadius(<span class="number">198.99</span>);</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			Circle circleCopy = (Circle) circle.clone();</div><div class="line">			System.out.println(<span class="string">"circle对象中的数据："</span> + circle.getRadius());</div><div class="line">			System.out.println(<span class="string">"circleCopy对象中的数据："</span> + circleCopy.getRadius());</div><div class="line">			circle.setRadius(<span class="number">200</span>);</div><div class="line">			System.out.println(<span class="string">"circle对象中的数据："</span> + circle.getRadius());</div><div class="line">			System.out.println(<span class="string">"circleCopy对象中的数据："</span> + circleCopy.getRadius());</div><div class="line">		&#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="深度克隆"><a href="#深度克隆" class="headerlink" title="深度克隆"></a>深度克隆</h1><p>Object类中的clone()方法将复制当前对象变量中的值来创建一个新对象，例如，一个对象Object有两个int型的成员变量x、y，那么该对象a与它调用clone()方法返回的cloneObject对象如图所示。<br><img src="http://i4.piimg.com/4851/986351540b062e73.png" alt=""></p>
<p>需要注意的是，如果调用clone()方法的当前对象拥有的成员变量是一个对象，那么clone()方法仅仅复制了当前对象所拥有的对象的引用，并没有复制这个对象所拥有的变量，这就是使clone()方法返回的新对象和当前对象拥有一个相同的对象，未能实现完全意义的复制。例如一个对象Object有两个变量rectangle和height，其中height是int型变量，但是变量rectangle是一个对象，这个对象rectangle有两个double型的变量m、n，那么对象object与它调用clone()方法返回的cloneObject对象如图所示。<br><img src="http://i4.piimg.com/4851/9f8cdfe258592302.png" alt=""></p>
<p>这样一来就涉及一个深度克隆问题，因为，当前对象的成员变量中可能还会有其他对象。所以使用clone()方法复制对象有许多细节问题需要考虑，比如，在重写clone()方法时，必须也要对当前对象中的rectangle对象进行复制。下面DeepCloneExample使用clone()方法克隆自己并处理了深度克隆的问题。</p>
<h2 id="注释掉了处理深度克隆的代码"><a href="#注释掉了处理深度克隆的代码" class="headerlink" title="注释掉了处理深度克隆的代码"></a>注释掉了处理深度克隆的代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Prototype;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Geometry</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> height;</div><div class="line">	Rectangle rectangle;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Geometry</span><span class="params">(<span class="keyword">int</span> height, Rectangle rectangle)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.height = height;</div><div class="line">		<span class="keyword">this</span>.rectangle = rectangle;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</div><div class="line">		Geometry object = (Geometry) <span class="keyword">super</span>.clone();</div><div class="line">		<span class="comment">//object.rectangle = (Rectangle) rectangle.clone();</span></div><div class="line">		<span class="keyword">return</span> object;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</div><div class="line">	<span class="keyword">double</span> m, n;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Rectangle</span><span class="params">(<span class="keyword">double</span> m, <span class="keyword">double</span> n)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.m = m;</div><div class="line">		<span class="keyword">this</span>.n = n;</div><div class="line">	&#125;</div><div class="line"></div><div class="line"><span class="comment">//	@Override</span></div><div class="line"><span class="comment">//	protected Object clone() throws CloneNotSupportedException &#123;</span></div><div class="line"><span class="comment">//		return super.clone();</span></div><div class="line"><span class="comment">//	&#125;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeepCloneExample</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Geometry geometry = <span class="keyword">new</span> Geometry(<span class="number">100</span>, <span class="keyword">new</span> Rectangle(<span class="number">10</span>, <span class="number">20</span>));</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			Geometry geometryCopy = (Geometry) geometry.clone();</div><div class="line">			System.out.println(<span class="string">"geometry对象中的rectangle矩形的长和宽："</span>);</div><div class="line">			System.out.println(geometry.rectangle.m + <span class="string">","</span> + geometry.rectangle.n);</div><div class="line">			System.out.println(<span class="string">"geometryCopy对象中的rectangle矩形的长和宽："</span>);</div><div class="line">			System.out.println(geometryCopy.rectangle.m + <span class="string">","</span> + geometryCopy.rectangle.n);</div><div class="line">			System.out.println(<span class="string">"geometry对象修改其中的rectangle矩形的长和宽："</span>);</div><div class="line">			geometry.rectangle.m = <span class="number">100</span>;</div><div class="line">			geometry.rectangle.n = <span class="number">200</span>;</div><div class="line">			System.out.println(<span class="string">"geometry对象中的rectangle矩形的长和宽："</span>);</div><div class="line">			System.out.println(geometry.rectangle.m + <span class="string">","</span> + geometry.rectangle.n);</div><div class="line">			System.out.println(<span class="string">"geometryCopy对象中的rectangle矩形的长和宽："</span>);</div><div class="line">			System.out.println(geometryCopy.rectangle.m + <span class="string">","</span> + geometryCopy.rectangle.n);</div><div class="line">		&#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="注释掉了处理深度克隆的代码的程序运行效果图"><a href="#注释掉了处理深度克隆的代码的程序运行效果图" class="headerlink" title="注释掉了处理深度克隆的代码的程序运行效果图"></a>注释掉了处理深度克隆的代码的程序运行效果图</h2><p><img src="http://i2.buimg.com/4851/01c3571c0bfd3568.png" alt=""></p>
<h2 id="把注释去掉之后处理了深克隆的运行效果图"><a href="#把注释去掉之后处理了深克隆的运行效果图" class="headerlink" title="把注释去掉之后处理了深克隆的运行效果图"></a>把注释去掉之后处理了深克隆的运行效果图</h2><p><img src="http://i2.buimg.com/4851/703c8d24abbdc5a3.png" alt=""></p>
<h1 id="序列化-Serializable接口与克隆对象"><a href="#序列化-Serializable接口与克隆对象" class="headerlink" title="序列化 Serializable接口与克隆对象"></a>序列化 Serializable接口与克隆对象</h1><p>相对于clone()方法，Java又提供了一种较简单的解决方案，这个方案就是使用Serializable接口和对象流来复制对象。<br>如果希望得到对象object的复制品，必须保证该对象是序列化的，即创建object对象的类必须实现Serializable接口。Serializable接口中的方法对程序是不可见的，因此实现该接口的类不需要实现额外的方法。<br>为了得到object的复制品，首先需要将object写入ObjectOutputStream流中，当把一个序列化的对象写入ObjectInputStream输出流时，JVM就会实现Serializable接口中的方法，将一定格式的文本–对象的序列化信息，写入ObjectOutputStream输出流的目的地。然后使用ObjectInputStream对象输入流从ObjectOutputStream输出流的目的地读取对象，这时ObjectInputStream对象流就读回object对象的序列化信息，并根据序列化信息创建一个新的对象，这个新对象就是object对象的一个复制品。<br>需要注意的是，使用对象流把一个对象写入文件时不仅要保证该对象是序列化的，而且该对象的成员对象也必须是序列化的。</p>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Abstract-Prototype的接口类MilitaryPerson-java"><a href="#Abstract-Prototype的接口类MilitaryPerson-java" class="headerlink" title="Abstract Prototype的接口类MilitaryPerson.java"></a>Abstract Prototype的接口类MilitaryPerson.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Prototype;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Prototype</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">cloneMe</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Abstract-Prototype的实现类Cubic-java"><a href="#Abstract-Prototype的实现类Cubic-java" class="headerlink" title="Abstract Prototype的实现类Cubic.java"></a>Abstract Prototype的实现类Cubic.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Prototype;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cubic</span> <span class="keyword">implements</span> <span class="title">Prototype</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">double</span> length,width,heigth;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Cubic</span><span class="params">(<span class="keyword">double</span> length, <span class="keyword">double</span> width, <span class="keyword">double</span> heigth)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.length = length;</div><div class="line">		<span class="keyword">this</span>.width = width;</div><div class="line">		<span class="keyword">this</span>.heigth = heigth;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">cloneMe</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</div><div class="line">		Object object = (Cubic)clone();        <span class="comment">//调用从Object类继承的clone方法</span></div><div class="line">		<span class="keyword">return</span> object;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Abstract-Prototype的实现类Goat-java"><a href="#Abstract-Prototype的实现类Goat-java" class="headerlink" title="Abstract Prototype的实现类Goat.java"></a>Abstract Prototype的实现类Goat.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Prototype;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</div><div class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</div><div class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</div><div class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</div><div class="line"><span class="keyword">import</span> java.io.Serializable;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Goat</span> <span class="keyword">implements</span> <span class="title">Prototype</span>, <span class="title">Serializable</span> </span>&#123;</div><div class="line"></div><div class="line">	StringBuffer color;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> StringBuffer <span class="title">getColor</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> color;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setColor</span><span class="params">(StringBuffer color)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.color = color;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">cloneMe</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</div><div class="line">		Object object = <span class="keyword">null</span>;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			ByteArrayOutputStream outOne = <span class="keyword">new</span> ByteArrayOutputStream();</div><div class="line">			ObjectOutputStream outTwo = <span class="keyword">new</span> ObjectOutputStream(outOne);</div><div class="line">			outTwo.writeObject(<span class="keyword">this</span>);    <span class="comment">//将原型对象写入对象输出流</span></div><div class="line">			ByteArrayInputStream inOne = <span class="keyword">new</span> ByteArrayInputStream(outOne.toByteArray());</div><div class="line">			ObjectInputStream inTwo = <span class="keyword">new</span> ObjectInputStream(inOne);</div><div class="line">			object = inTwo.readObject();  <span class="comment">//创建新的对象，原型的复制品</span></div><div class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> object;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Prototype;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Cubic cubic = <span class="keyword">new</span> Cubic(<span class="number">12</span>, <span class="number">20</span>, <span class="number">66</span>);</div><div class="line">		System.out.println(<span class="string">"cubic的长、宽、高："</span>);</div><div class="line">		System.out.println(cubic.length + <span class="string">","</span> + cubic.width + <span class="string">","</span></div><div class="line">				+ cubic.heigth);</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			Cubic cubicCopy = (Cubic) cubic.cloneMe();</div><div class="line">			System.out.println(<span class="string">"cubicCopy的长、宽、高："</span>);</div><div class="line">			System.out.println(cubicCopy.length + <span class="string">","</span> + cubicCopy.width + <span class="string">","</span></div><div class="line">					+ cubicCopy.heigth);</div><div class="line">		&#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		Goat goat = <span class="keyword">new</span> Goat();</div><div class="line">		goat.setColor(<span class="keyword">new</span> StringBuffer(<span class="string">"白颜色的山羊"</span>));</div><div class="line">		System.out.println(<span class="string">"goat是"</span> + goat.getColor());</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			Goat goatCopy = (Goat) goat.cloneMe();</div><div class="line">			System.out.println(<span class="string">"goatCopy是"</span> + goatCopy.getColor());</div><div class="line">			System.out.println(<span class="string">"goatCopy将自己的颜色改变成黑色"</span>);</div><div class="line">			goatCopy.setColor(<span class="keyword">new</span> StringBuffer(<span class="string">"黑颜色的山羊"</span>));</div><div class="line">			System.out.println(<span class="string">"goat仍然是"</span> + goat.getColor());</div><div class="line">			System.out.println(<span class="string">"goatCopy是"</span> + goatCopy.getColor());</div><div class="line">		&#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="执行效果图"><a href="#执行效果图" class="headerlink" title="执行效果图"></a>执行效果图</h1><p><img src="http://i4.piimg.com/4851/0cf4b415691e9b6a.png" alt=""></p>
<h1 id="原型模式的优点"><a href="#原型模式的优点" class="headerlink" title="原型模式的优点"></a>原型模式的优点</h1><ul>
<li>当创建类的新实例的代价更大时，使用原型模式复制一个已有的实例可以提高创建新实例的效率。</li>
<li>可以动态地保存当前对象的状态。在运行时，可以随时使用对象流保存当前对象的一个复制品。</li>
<li>可以在运行时创建新的对象，而无须创建一系列类和继承结构。</li>
<li>可以动态地添加、删除原型的复制品。</li>
</ul>
<h1 id="适用原型模式的情景"><a href="#适用原型模式的情景" class="headerlink" title="适用原型模式的情景"></a>适用原型模式的情景</h1><ul>
<li>程序需要从一个对象出发，得到若干个和其状态相同，并可独立变化其状态的对象时。</li>
<li>当对象的创建需要独立于它的构造过程和表示时。</li>
<li>一个类创建实例状态不是很多，那么就可以将这个类的一个实例定义为原型，那么通过复制该原型得到新的实例可能比重新使用类的构造方法创建新实例更方便。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/原型模式/">原型模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--单例模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/19/Java设计模式--单例模式/" class="article-date">
      <time datetime="2016-09-19T01:01:06.000Z" itemprop="datePublished">2016-09-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/19/Java设计模式--单例模式/">Java设计模式--单例模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h1><p>保证一个类仅有一个实例，并提供一个访问它的全局访问点。</p>
<h1 id="Singleton-Pattern"><a href="#Singleton-Pattern" class="headerlink" title="Singleton Pattern"></a>Singleton Pattern</h1><p>Ensure a class only has one instance, and provide a global point of access to it.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://ww1.sinaimg.cn/large/0060lm7Tgw1f7ymszqsfzj30cu08d3yz.jpg" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>单例方法模式的结构中包括一种角色。</p>
<ul>
<li>单件类（Singleton）：单件类只可以创建出一个实例。</li>
</ul>
<h1 id="java中单例模式是一种常见的设计模式，单例模式的写法有好几种，这里主要介绍三种："><a href="#java中单例模式是一种常见的设计模式，单例模式的写法有好几种，这里主要介绍三种：" class="headerlink" title="java中单例模式是一种常见的设计模式，单例模式的写法有好几种，这里主要介绍三种："></a>java中单例模式是一种常见的设计模式，单例模式的写法有好几种，这里主要介绍三种：</h1><ul>
<li>懒汉式单例</li>
<li>饿汉式单例</li>
<li>登记式单例</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="懒汉式单例-java"><a href="#懒汉式单例-java" class="headerlink" title="懒汉式单例.java"></a>懒汉式单例.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Singleton;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> yxx</div><div class="line"> * 懒汉式单例类，在第一次调用的时候实例化自己</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span></span>&#123;&#125;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Singleton single = <span class="keyword">null</span>;</div><div class="line">	<span class="comment">//静态工厂方法</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (single == <span class="keyword">null</span>) &#123;</div><div class="line">			single = <span class="keyword">new</span> Singleton();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> single;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Singleton通过将构造方法限定为private避免了类在外部被实例化，在同一个虚拟机范围内，Singleton的唯一实例只能通过getInstance()方法访问。<br>（事实上，通过Java反射机制是能够实例化构造方法为private的类的，那基本上会使所有的Java单例实现失效。此问题在此处不做讨论，姑且掩耳盗铃地认为反射机制不存在。）</p>
<p>但是以上懒汉式单例的实现没有考虑线程安全问题，它是线程不安全的，并发环境下很可能出现多个Singleton实例，要实现线程安全，有以下三种方式，都是对getInstance这个方法改造，保证了懒汉式单例的线程安全，如果你第一次接触单例模式，对线程安全不是很了解，可以先跳过下面这三小条，去看饿汉式单例，等看完后面再回头考虑线程安全的问题。</p>
<h2 id="在getInstance方法上加同步"><a href="#在getInstance方法上加同步" class="headerlink" title="在getInstance方法上加同步"></a>在getInstance方法上加同步</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Singleton;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> yxx</div><div class="line"> * 懒汉式单例类，在第一次调用的时候实例化自己</div><div class="line"> * 在getInstance方法上加同步</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonSynchronized</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="title">SingletonSynchronized</span><span class="params">()</span></span>&#123;&#125;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> SingletonSynchronized single = <span class="keyword">null</span>;</div><div class="line">	<span class="comment">//静态工厂方法</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> SingletonSynchronized <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (single == <span class="keyword">null</span>) &#123;</div><div class="line">			single = <span class="keyword">new</span> SingletonSynchronized();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> single;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="双重检查锁定"><a href="#双重检查锁定" class="headerlink" title="双重检查锁定"></a>双重检查锁定</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Singleton;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> yxx</div><div class="line"> * 懒汉式单例类，在第一次调用的时候实例化自己</div><div class="line"> * 双重检查锁定</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonDoubleChecked</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="title">SingletonDoubleChecked</span><span class="params">()</span></span>&#123;&#125;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> SingletonDoubleChecked single = <span class="keyword">null</span>;</div><div class="line">	<span class="comment">//静态工厂方法</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SingletonDoubleChecked <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (single == <span class="keyword">null</span>) &#123;</div><div class="line">			<span class="keyword">synchronized</span> (SingletonDoubleChecked.class) &#123;</div><div class="line">				<span class="keyword">if</span> (single == <span class="keyword">null</span>) &#123;</div><div class="line">					single = <span class="keyword">new</span> SingletonDoubleChecked();</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> single;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="静态内部类，既实现了线程安全，又避免了同步带来的性能影响"><a href="#静态内部类，既实现了线程安全，又避免了同步带来的性能影响" class="headerlink" title="静态内部类，既实现了线程安全，又避免了同步带来的性能影响"></a>静态内部类，既实现了线程安全，又避免了同步带来的性能影响</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Singleton;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> yxx</div><div class="line"> * 懒汉式单例类，在第一次调用的时候实例化自己</div><div class="line"> * 既实现了线程安全，又避免了同步带来的性能影响</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonStatic</span> </span>&#123;    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">LazyHolder</span> </span>&#123;    </div><div class="line">       <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> SingletonStatic INSTANCE = <span class="keyword">new</span> SingletonStatic();    </div><div class="line">    &#125;    </div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SingletonStatic</span> <span class="params">()</span></span>&#123;&#125;    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> SingletonStatic <span class="title">getInstance</span><span class="params">()</span> </span>&#123;    </div><div class="line">       <span class="keyword">return</span> LazyHolder.INSTANCE;    </div><div class="line">    &#125;    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="饿汉式单例模式"><a href="#饿汉式单例模式" class="headerlink" title="饿汉式单例模式"></a>饿汉式单例模式</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Singleton;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * <span class="doctag">@author</span> yxx</div><div class="line"> * 饿汉式单例类，在类初始化时，已经自行实例化</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton2</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">private</span> <span class="title">Singleton2</span><span class="params">()</span> </span>&#123;&#125;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton2 single = <span class="keyword">new</span> Singleton2();</div><div class="line"></div><div class="line">	<span class="comment">// 静态工厂方法</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton2 <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> single;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>饿汉式在类创建的同时就已经创建好一个静态的对象供系统使用，以后不再改变，所以天生是线程安全的。</p>
<p>登记式单例实际上维护了一组单例类的实例，将这些实例存放在一个Map（登记薄）中，对于已经登记过的实例，则从Map直接返回，对于没有登记的，则先登记，然后返回。 </p>
<p>这里我对登记式单例标记了可忽略，我的理解来说，首先它用的比较少，另外其实内部实现还是用的饿汉式单例，因为其中的static方法块，它的单例在类被装载的时候就被实例化了。</p>
<h1 id="饿汉式和懒汉式区别"><a href="#饿汉式和懒汉式区别" class="headerlink" title="饿汉式和懒汉式区别"></a>饿汉式和懒汉式区别</h1><p>从名字上来说，饿汉和懒汉，饿汉就是类一旦加载，就把单例初始化完成，保证getInstance的时候，单例是已经存在的了，而懒汉比较懒，只有当调用getInstance的时候，才回去初始化这个单例。另外从以下两点再区分以下这两种方式：<br>1、线程安全：<br>饿汉式天生就是线程安全的，可以直接用于多线程而不会出现问题，懒汉式本身是非线程安全的，为了实现线程安全有几种写法，分别是上面的1、2、3，这三种实现在资源加载和性能方面有些区别。<br>2、资源加载和性能：<br>饿汉式在类创建的同时就实例化一个静态对象出来，不管之后会不会使用这个单例，都会占据一定的内存，但是相应的，在第一次调用时速度也会更快，因为其资源已经初始化完成，而懒汉式顾名思义，会延迟加载，在第一次使用该单例的时候才会实例化对象出来，第一次调用时要做初始化，如果要做的工作比较多，性能上会有些延迟，之后就和饿汉式一样了。</p>
<p>至于1、2、3这三种实现又有些区别，<br>第1种，在方法调用上加了同步，虽然线程安全了，但是每次都要同步，会影响性能，毕竟99%的情况下是不需要同步的，<br>第2种，在getInstance中做了两次null检查，确保了只有第一次调用单例的时候才会做同步，这样也是线程安全的，同时避免了每次都同步的性能损耗<br>第3种，利用了classloader的机制来保证初始化instance时只有一个线程，所以也是线程安全的，同时没有性能损耗，所以一般我倾向于使用这一种。</p>
<h1 id="什么是线程安全？"><a href="#什么是线程安全？" class="headerlink" title="什么是线程安全？"></a>什么是线程安全？</h1><p>如果你的代码所在的进程中有多个线程在同时运行，而这些线程可能会同时运行这段代码。如果每次运行结果和单线程运行的结果是一样的，而且其他的变量的值也和预期的是一样的，就是线程安全的。或者说：一个类或者程序所提供的接口对于线程来说是原子操作，或者多个线程之间的切换不会导致该接口的执行结果存在二义性,也就是说我们不用考虑同步的问题，那就是线程安全的。</p>
<h1 id="单例模式的优点"><a href="#单例模式的优点" class="headerlink" title="单例模式的优点"></a>单例模式的优点</h1><ul>
<li>单例类的唯一实例由单例类本身控制，所以可以很好地控制用户何时访问它。</li>
</ul>
<h1 id="适用单例模式的情景"><a href="#适用单例模式的情景" class="headerlink" title="适用单例模式的情景"></a>适用单例模式的情景</h1><ul>
<li>当系统需要某个类只能有一个实例。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/单例模式/">单例模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--组合模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/17/Java设计模式--组合模式/" class="article-date">
      <time datetime="2016-09-17T09:33:06.000Z" itemprop="datePublished">2016-09-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/17/Java设计模式--组合模式/">Java设计模式--组合模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="组合模式"><a href="#组合模式" class="headerlink" title="组合模式"></a>组合模式</h1><p>将对象组合成树形结构以表示“部分-整体”的层次结构。Composite使用户对单个对象和组合对象的使用具有一致性。</p>
<h1 id="Composite-Pattern"><a href="#Composite-Pattern" class="headerlink" title="Composite Pattern"></a>Composite Pattern</h1><p>Compose objects into tree structures to represent part-whole hierarchies. Composite lets clients treat individual objects and compositions of objects uniformly.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://ww4.sinaimg.cn/large/0060lm7Tgw1f7y30gvbtxj30hy0crdha.jpg" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>组合方法模式的结构中包括三种角色。</p>
<ul>
<li>抽象组件（Abstract Component）：是一个接口（抽象类），该接口（抽象类）定义了个体对象和组合对象需要实现的关于操作其子节点的方法，比如add()、remove()以及getChild()等方法。抽象组件也可以定义个体对象和组合对象用于操作其自身的方法，比如isLeaf()方法等。</li>
<li>Composite（Composite Node）：实现Component接口类的实例，Composite节点不仅实现Component接口，而且可以含有其他Composite节点或Leaf节点的引用。</li>
<li>Leaf节点（Leaf Node）：实现Component接口类的实例，Leaf节点实现Composite接口，不可以含有其他Composite节点或Leaf节点的引用，因此，叶节点在实现Component接口有关操作子节点的方法时，比如add()、remove()和getChild()方法，可让方法抛出一个异常，也可以实现为空操作。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Component的接口类MilitaryPerson-java"><a href="#Component的接口类MilitaryPerson-java" class="headerlink" title="Component的接口类MilitaryPerson.java"></a>Component的接口类MilitaryPerson.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Component;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MilitaryPerson</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(MilitaryPerson person)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(MilitaryPerson person)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> MilitaryPerson <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> index)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> Iterator&lt;MilitaryPerson&gt; <span class="title">getAllChildren</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLeaf</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getSalary</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalary</span><span class="params">(<span class="keyword">double</span> salary)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Composite的实现类MilitaryOfficer-java"><a href="#Composite的实现类MilitaryOfficer-java" class="headerlink" title="Composite的实现类MilitaryOfficer.java"></a>Composite的实现类MilitaryOfficer.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Component;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"><span class="keyword">import</span> java.util.LinkedList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MilitaryOfficer</span> <span class="keyword">implements</span> <span class="title">MilitaryPerson</span> </span>&#123;</div><div class="line"></div><div class="line">	LinkedList&lt;MilitaryPerson&gt; list;</div><div class="line">	String name;</div><div class="line">	<span class="keyword">double</span> salary;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MilitaryOfficer</span><span class="params">(String name, <span class="keyword">double</span> salary)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">		<span class="keyword">this</span>.salary = salary;</div><div class="line">		list = <span class="keyword">new</span> LinkedList&lt;MilitaryPerson&gt;();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(MilitaryPerson person)</span> </span>&#123;</div><div class="line">		list.add(person);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(MilitaryPerson person)</span> </span>&#123;</div><div class="line">		list.remove(person);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> MilitaryPerson <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> list.get(index);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Iterator&lt;MilitaryPerson&gt; <span class="title">getAllChildren</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> list.iterator();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLeaf</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getSalary</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> salary;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalary</span><span class="params">(<span class="keyword">double</span> salary)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.salary = salary;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Leaf的实现类MilitarySoldier-java"><a href="#Leaf的实现类MilitarySoldier-java" class="headerlink" title="Leaf的实现类MilitarySoldier.java"></a>Leaf的实现类MilitarySoldier.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Component;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MilitarySoldier</span> <span class="keyword">implements</span> <span class="title">MilitaryPerson</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">double</span> salary;</div><div class="line">	String name;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MilitarySoldier</span><span class="params">(<span class="keyword">double</span> salary, String name)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.salary = salary;</div><div class="line">		<span class="keyword">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(MilitaryPerson person)</span> </span>&#123;&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(MilitaryPerson person)</span> </span>&#123;&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> MilitaryPerson <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Iterator&lt;MilitaryPerson&gt; <span class="title">getAllChildren</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLeaf</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getSalary</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> salary;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalary</span><span class="params">(<span class="keyword">double</span> salary)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.salary = salary;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="计算工资的工具类ComputerSalary-java"><a href="#计算工资的工具类ComputerSalary-java" class="headerlink" title="计算工资的工具类ComputerSalary.java"></a>计算工资的工具类ComputerSalary.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Component;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.Iterator;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ComputerSalary</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">computerSalary</span><span class="params">(MilitaryPerson person)</span> </span>&#123;</div><div class="line">		<span class="keyword">double</span> sum = <span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span> (person.isLeaf() == <span class="keyword">true</span>) &#123;</div><div class="line">			sum = sum + person.getSalary();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (person.isLeaf() == <span class="keyword">false</span>) &#123;</div><div class="line">			sum = sum + person.getSalary();</div><div class="line">			Iterator&lt;MilitaryPerson&gt; iterator = person.getAllChildren();</div><div class="line">			<span class="keyword">while</span> (iterator.hasNext()) &#123;</div><div class="line">				MilitaryPerson p = iterator.next();</div><div class="line">				sum = sum + computerSalary(p);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> sum;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Component;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		MilitaryPerson 连长 = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"连长"</span>, <span class="number">5000</span>);</div><div class="line">		MilitaryPerson 排长<span class="number">1</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"一排长"</span>, <span class="number">4000</span>);</div><div class="line">		MilitaryPerson 排长<span class="number">2</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"二排长"</span>, <span class="number">4000</span>);</div><div class="line">		MilitaryPerson 排长<span class="number">3</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"三排长"</span>, <span class="number">4000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">11</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"一排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">12</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"二排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">13</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"三排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">21</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"一排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">22</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"二排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">23</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"三排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">31</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"一排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">32</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"二排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson 班长<span class="number">33</span> = <span class="keyword">new</span> MilitaryOfficer(<span class="string">"三排长"</span>, <span class="number">2000</span>);</div><div class="line">		MilitaryPerson[] 士兵 = <span class="keyword">new</span> MilitarySoldier[<span class="number">90</span>];</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; 士兵.length; i++) &#123;</div><div class="line">			士兵[i] = <span class="keyword">new</span> MilitarySoldier(<span class="number">1000</span>, <span class="string">"小兵"</span>);</div><div class="line">		&#125;</div><div class="line">		连长.add(排长<span class="number">1</span>);</div><div class="line">		连长.add(排长<span class="number">2</span>);</div><div class="line">		排长<span class="number">1</span>.add(班长<span class="number">11</span>);</div><div class="line">		排长<span class="number">1</span>.add(班长<span class="number">12</span>);</div><div class="line">		排长<span class="number">1</span>.add(班长<span class="number">13</span>);</div><div class="line">		排长<span class="number">2</span>.add(班长<span class="number">21</span>);</div><div class="line">		排长<span class="number">2</span>.add(班长<span class="number">22</span>);</div><div class="line">		排长<span class="number">2</span>.add(班长<span class="number">23</span>);</div><div class="line">		排长<span class="number">3</span>.add(班长<span class="number">31</span>);</div><div class="line">		排长<span class="number">3</span>.add(班长<span class="number">32</span>);</div><div class="line">		排长<span class="number">3</span>.add(班长<span class="number">33</span>);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; i++) &#123;</div><div class="line">			班长<span class="number">11</span>.add(士兵[i]);</div><div class="line">			班长<span class="number">12</span>.add(士兵[i + <span class="number">10</span>]);</div><div class="line">			班长<span class="number">13</span>.add(士兵[i + <span class="number">20</span>]);</div><div class="line">			班长<span class="number">21</span>.add(士兵[i + <span class="number">30</span>]);</div><div class="line">			班长<span class="number">22</span>.add(士兵[i + <span class="number">40</span>]);</div><div class="line">			班长<span class="number">23</span>.add(士兵[i + <span class="number">50</span>]);</div><div class="line">			班长<span class="number">31</span>.add(士兵[i + <span class="number">60</span>]);</div><div class="line">			班长<span class="number">32</span>.add(士兵[i + <span class="number">70</span>]);</div><div class="line">			班长<span class="number">33</span>.add(士兵[i + <span class="number">80</span>]);</div><div class="line">		&#125;</div><div class="line">		System.out.println(<span class="string">"一排的军饷:"</span> + ComputerSalary.computerSalary(排长<span class="number">1</span>));</div><div class="line">		System.out.println(<span class="string">"一班的军饷:"</span> + ComputerSalary.computerSalary(班长<span class="number">11</span>));</div><div class="line">		System.out.println(<span class="string">"全连的军饷:"</span> + ComputerSalary.computerSalary(连长));</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="执行效果图"><a href="#执行效果图" class="headerlink" title="执行效果图"></a>执行效果图</h1><p><img src="http://ww1.sinaimg.cn/large/0060lm7Tgw1f7y3oc3j9lj30d604tjsc.jpg" alt=""></p>
<h1 id="组合模式的优点"><a href="#组合模式的优点" class="headerlink" title="组合模式的优点"></a>组合模式的优点</h1><ul>
<li>组合模式中包含个体对象和组合对象，并形成树形结构，使用户可以方便地处理个体对象和组合对象。</li>
<li>组合对象和个体对象实现了相同的接口，用户一般无须区分个体对象和组合对象。</li>
<li>当增加新的Composite节点和Leaf节点时，用户的重要代码不需要作出修改，例如，如果增加一个创建企业领导和一般职员的Composite节点和Leaf节点，那么ComputerSalary并不需要修改，就可以计算一个部门的薪水总和。</li>
</ul>
<h1 id="适用组合模式的情景"><a href="#适用组合模式的情景" class="headerlink" title="适用组合模式的情景"></a>适用组合模式的情景</h1><ul>
<li>当想表示对象的部分-整体层次结构。</li>
<li>希望用户用一致的方式处理个体对象和组合对象。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/组合模式/">组合模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
    <article id="post-Java设计模式--桥接模式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/09/17/Java设计模式--桥接模式/" class="article-date">
      <time datetime="2016-09-17T07:15:06.000Z" itemprop="datePublished">2016-09-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/17/Java设计模式--桥接模式/">Java设计模式--桥接模式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="桥接模式（别名：柄体模式）"><a href="#桥接模式（别名：柄体模式）" class="headerlink" title="桥接模式（别名：柄体模式）"></a>桥接模式（别名：柄体模式）</h1><p>将抽象部分于它的实现部分分离，使它们都可以独立地变化。</p>
<h1 id="Bridge-Pattern（Another-Name：Handle-Body）"><a href="#Bridge-Pattern（Another-Name：Handle-Body）" class="headerlink" title="Bridge Pattern（Another Name：Handle-Body）"></a>Bridge Pattern（Another Name：Handle-Body）</h1><p>Decouple an abstraction from its implementation so that the two can vary independently.</p>
<h1 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h1><p><img src="http://i1.piimg.com/4851/c1df39cd4c5e374b.png" alt=""></p>
<h1 id="模式的结构与使用"><a href="#模式的结构与使用" class="headerlink" title="模式的结构与使用"></a>模式的结构与使用</h1><p>桥接模式的结构中包括四种角色。</p>
<ul>
<li>抽象（Abstraction）：是一个抽象类，该抽象类含有Implementor声明的变量，即维护一个Implementor类型对象。</li>
<li>实现者（Implementor）：实现者角色是一个接口（抽象类），该接口（抽象类）中的方法不一定与Abstraction类中的方法一致。Implementor接口（抽象类）负责定义基本操作，而Abstraction类负责定义基于这些基本操作的较高层次的操作。</li>
<li>细化抽象（Refined Abstration）：细化抽象是抽象角色的一个子类，该子类在重写（覆盖）抽象角色中的抽象方法时，在给出一些必要的操作后，将委托所维护Implementor类型对象调用相应的方法。</li>
<li>具体实现者（Concrete Implementor）：具体实现者是实现（扩展）Implementor接口（抽象类）的类。</li>
</ul>
<h1 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h1><h2 id="Abstract-Template的抽象类CCTV-java"><a href="#Abstract-Template的抽象类CCTV-java" class="headerlink" title="Abstract Template的抽象类CCTV.java"></a>Abstract Template的抽象类CCTV.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JPanel;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CCTV</span> <span class="keyword">extends</span> <span class="title">JPanel</span> </span>&#123;</div><div class="line">	Program programMaker;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">makeProgram</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Abstract-Template的实现类CCTV5-java"><a href="#Abstract-Template的实现类CCTV5-java" class="headerlink" title="Abstract Template的实现类CCTV5.java"></a>Abstract Template的实现类CCTV5.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.awt.BorderLayout;</div><div class="line"><span class="keyword">import</span> java.awt.Font;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JLabel;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CCTV5</span> <span class="keyword">extends</span> <span class="title">CCTV</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</div><div class="line"></div><div class="line">	JLabel showFilm;</div><div class="line">	Thread thread;</div><div class="line">	ArrayList&lt;String&gt; content;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CCTV5</span><span class="params">(Program program)</span> </span>&#123;</div><div class="line">		programMaker = program;</div><div class="line">		setLayout(<span class="keyword">new</span> BorderLayout());</div><div class="line">		showFilm = <span class="keyword">new</span> JLabel(<span class="string">"CCTV5频道"</span>);</div><div class="line">		showFilm.setFont(<span class="keyword">new</span> Font(<span class="string">""</span>, Font.BOLD, <span class="number">39</span>));</div><div class="line">		add(showFilm, BorderLayout.CENTER);</div><div class="line">		thread = <span class="keyword">new</span> Thread(<span class="keyword">this</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content = programMaker.makeTVProgram();</div><div class="line">		<span class="keyword">if</span> (!thread.isAlive()) &#123;</div><div class="line">			thread = <span class="keyword">new</span> Thread(<span class="keyword">this</span>);</div><div class="line">			thread.start();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; content.size(); i++) &#123;</div><div class="line">			showFilm.setText(content.get(i));</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				Thread.sleep(<span class="number">500</span>);</div><div class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Abstract-Template的实现类CCTV6-java"><a href="#Abstract-Template的实现类CCTV6-java" class="headerlink" title="Abstract Template的实现类CCTV6.java"></a>Abstract Template的实现类CCTV6.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.awt.BorderLayout;</div><div class="line"><span class="keyword">import</span> java.awt.Font;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JLabel;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CCTV6</span> <span class="keyword">extends</span> <span class="title">CCTV</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</div><div class="line"></div><div class="line">	JLabel showFilm;</div><div class="line">	Thread thread;</div><div class="line">	ArrayList&lt;String&gt; content;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CCTV6</span><span class="params">(Program program)</span> </span>&#123;</div><div class="line">		programMaker = program;</div><div class="line">		setLayout(<span class="keyword">new</span> BorderLayout());</div><div class="line">		showFilm = <span class="keyword">new</span> JLabel(<span class="string">"CCTV6频道"</span>);</div><div class="line">		showFilm.setFont(<span class="keyword">new</span> Font(<span class="string">""</span>, Font.BOLD, <span class="number">39</span>));</div><div class="line">		add(showFilm, BorderLayout.CENTER);</div><div class="line">		thread = <span class="keyword">new</span> Thread(<span class="keyword">this</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content = programMaker.makeTVProgram();</div><div class="line">		<span class="keyword">if</span> (!thread.isAlive()) &#123;</div><div class="line">			thread = <span class="keyword">new</span> Thread(<span class="keyword">this</span>);</div><div class="line">			thread.start();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; content.size(); i++) &#123;</div><div class="line">			showFilm.setText(content.get(i));</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				Thread.sleep(<span class="number">500</span>);</div><div class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Implementor的接口类Program-java"><a href="#Implementor的接口类Program-java" class="headerlink" title="Implementor的接口类Program.java"></a>Implementor的接口类Program.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Program</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> ArrayList&lt;String&gt; <span class="title">makeTVProgram</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Implementor的实现类AthleticProgram-java"><a href="#Implementor的实现类AthleticProgram-java" class="headerlink" title="Implementor的实现类AthleticProgram.java"></a>Implementor的实现类AthleticProgram.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AthleticProgram</span> <span class="keyword">implements</span> <span class="title">Program</span> </span>&#123;</div><div class="line"></div><div class="line">	ArrayList&lt;String&gt; content;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">AthleticProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> ArrayList&lt;String&gt; <span class="title">makeTVProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content.clear();</div><div class="line">		content.add(<span class="string">"足球直播"</span>);</div><div class="line">		content.add(<span class="string">"篮球直播"</span>);</div><div class="line">		content.add(<span class="string">"羽毛球直播"</span>);</div><div class="line">		content.add(<span class="string">"兵乓球直播"</span>);</div><div class="line">		content.add(<span class="string">"直播结束"</span>);</div><div class="line">		<span class="keyword">return</span> content;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Implementor的实现类FilmProgram-java"><a href="#Implementor的实现类FilmProgram-java" class="headerlink" title="Implementor的实现类FilmProgram.java"></a>Implementor的实现类FilmProgram.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilmProgram</span> <span class="keyword">implements</span> <span class="title">Program</span> </span>&#123;</div><div class="line"></div><div class="line">	ArrayList&lt;String&gt; content;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">FilmProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> ArrayList&lt;String&gt; <span class="title">makeTVProgram</span><span class="params">()</span> </span>&#123;</div><div class="line">		content.clear();</div><div class="line">		content.add(<span class="string">"惊天魔盗团"</span>);</div><div class="line">		content.add(<span class="string">"兵临城下"</span>);</div><div class="line">		content.add(<span class="string">"海芋恋"</span>);</div><div class="line">		content.add(<span class="string">"寒战"</span>);</div><div class="line">		content.add(<span class="string">"电影结束"</span>);</div><div class="line">		<span class="keyword">return</span> content;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="测试类Application-java"><a href="#测试类Application-java" class="headerlink" title="测试类Application.java"></a>测试类Application.java</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> Bridge;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.awt.BorderLayout;</div><div class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</div><div class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</div><div class="line"></div><div class="line"><span class="keyword">import</span> javax.swing.JButton;</div><div class="line"><span class="keyword">import</span> javax.swing.JFrame;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> <span class="keyword">extends</span> <span class="title">JFrame</span> </span>&#123;</div><div class="line"></div><div class="line">	JButton seeProgram;</div><div class="line">	CCTV cctv;</div><div class="line">	Program program;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Application</span><span class="params">(CCTV tv, Program program)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.cctv = tv;</div><div class="line">		<span class="keyword">this</span>.program = program;</div><div class="line">		add(cctv, BorderLayout.CENTER);</div><div class="line">		seeProgram = <span class="keyword">new</span> JButton(<span class="string">"看节目"</span>);</div><div class="line">		add(seeProgram, BorderLayout.SOUTH);</div><div class="line">		seeProgram.addActionListener(<span class="keyword">new</span> ActionListener() &#123;</div><div class="line">			</div><div class="line">			<span class="meta">@Override</span></div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</div><div class="line">				cctv.makeProgram();</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">		setVisible(<span class="keyword">true</span>);</div><div class="line">		setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		Program program = <span class="keyword">new</span> AthleticProgram();</div><div class="line">		CCTV cctv = <span class="keyword">new</span> CCTV5(program);</div><div class="line">		Application application1 = <span class="keyword">new</span> Application(cctv, program);</div><div class="line">		application1.setBounds(<span class="number">10</span>, <span class="number">10</span>, <span class="number">200</span>, <span class="number">300</span>);</div><div class="line">		program = <span class="keyword">new</span> FilmProgram();</div><div class="line">		cctv = <span class="keyword">new</span> CCTV6(program);</div><div class="line">		Application application2 = <span class="keyword">new</span> Application(cctv, program);</div><div class="line">		application2.setBounds(<span class="number">220</span>, <span class="number">10</span>, <span class="number">200</span>, <span class="number">300</span>);	</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="运行截图"><a href="#运行截图" class="headerlink" title="运行截图"></a>运行截图</h1><p><img src="http://i2.buimg.com/4851/c22c3dbeac863c85.png" alt=""></p>
<h1 id="桥接模式的优点"><a href="#桥接模式的优点" class="headerlink" title="桥接模式的优点"></a>桥接模式的优点</h1><ul>
<li>桥接模式分离实现与抽象，使抽象和实现可以独立的扩展。当修改实现的代码时，不影响抽象的代码，反之也一样。</li>
<li>满足开闭-原则。抽象和实现者处于同层次，使系统可独立地扩展这两个层次。增加新的具体实现者，不需要修改细化抽象，反之增加新的细化抽象也不需要修改具体实现。</li>
</ul>
<h1 id="适用桥接模式的情景"><a href="#适用桥接模式的情景" class="headerlink" title="适用桥接模式的情景"></a>适用桥接模式的情景</h1><ul>
<li>不想让抽象和某些重要的实现代码是固定的绑定关系，这部分实现可运行时动态决定。</li>
<li>抽象和实现者都可以继承的方式独立地扩充而互不影响，程序在运行期间可能需要动态的将一个抽象的子类的实例与一个实现者的子类的实例进行结合。</li>
<li>希望对实现者层次代码的修改对抽象层不产生影响，即抽象层的代码不必重新编译，反之亦然。</li>
</ul>
<h1 id="下载源码请到"><a href="#下载源码请到" class="headerlink" title="下载源码请到"></a>下载源码请到</h1><p><a href="https://github.com/androidwolf" target="_blank" rel="external">MyGitHub</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/桥接模式/">桥接模式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








    
        <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
        <script>
            var yiliaConfig = {
            fancybox: true,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
            }
        </script>
        

  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2016 yxx
            </div>
            <div class="footer-right">
                <a href="https://androidwolf.github.io/" target="_blank" title="叶显秀的Github">yxx@版权所有，翻版绝对不究</a>
            </div>
        </div>
        <div class="visit">
            <span id="busuanzi_container_site_pv" style='display:none'>
                <span id="site-visit" >本站到访数: 
                    <span id="busuanzi_value_site_uv"></span>
                </span>
            </span>
            <span id="busuanzi_container_page_pv" style='display:none'>
                <span id="page-visit">, 本页阅读量: 
                    <span id="busuanzi_value_page_pv"></span>
                </span>
            </span>
        </div>
    </div>
</footer>
    </div>
    
    <script>
        var yiliaConfig = {
            fancybox: false,
            mathjax: true,
            animate: true,
            isHome: true,
            isPost: false,
            isArchive: false,
            isTag: false,
            isCategory: false,
            open_in_new: false
        }
    </script>


<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>